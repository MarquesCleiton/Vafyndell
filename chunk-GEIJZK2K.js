import{a as L}from"./chunk-CDJK5DZR.js";import{a as B}from"./chunk-J5FBOTGS.js";import{h as V}from"./chunk-SEBSZRO5.js";import{g as T,i as A,q as N,x as R}from"./chunk-IJWXOQAR.js";import{Ab as s,Bb as i,Cb as n,Db as y,Hb as O,Ib as P,Jb as F,Nb as p,Pb as u,Sa as C,Ua as r,Za as E,Zb as j,a as _,b as v,bc as t,cc as x,dc as d,eb as S,g as f,jb as w,la as b,ma as h,mc as k,rc as z,wb as D,xb as I,yb as M,zb as J}from"./chunk-O42C4TWY.js";var X=l=>({"text-danger fw-bold":l}),q=(l,e)=>e.label;function G(l,e){l&1&&(i(0,"div",4),y(1,"div",9),i(2,"p",10),t(3,"Carregando jogador..."),n()())}function H(l,e){if(l&1){let a=F();O(0),i(1,"img",21),p("click",function(){b(a);let m=u(2);return h(m.abrirImagem(m.jogador.imagem))}),n(),P()}if(l&2){let a=u(2);r(),s("src",a.jogador.imagem,C)}}function K(l,e){l&1&&(i(0,"div",22),t(1," \u{1F464} "),n())}function Q(l,e){if(l&1&&(i(0,"div",20),t(1),i(2,"span"),t(3),n(),i(4,"b"),t(5),n(),i(6,"small",23),t(7),n()()),l&2){let a=e.$implicit;r(),d(" ",a.icon," "),r(2),x(a.label),r(2),x(a.value),r(2),d(" (",a.mod>=0?"+"+a.mod:a.mod,") ")}}function W(l,e){if(l&1&&(i(0,"div",5)(1,"div",11),w(2,H,2,1,"ng-container",12)(3,K,2,0,"ng-template",null,0,z),n(),i(5,"div",13)(6,"h4",14),t(7),n(),i(8,"p",15),t(9),n(),i(10,"ul",16)(11,"li"),t(12,"\u{1F3C5} "),i(13,"span"),t(14,"N\xEDvel:"),n(),t(15),n(),i(16,"li"),t(17,"\u2B50 "),i(18,"span"),t(19,"XP:"),n(),t(20),n(),i(21,"li"),t(22," \u2764\uFE0F "),i(23,"span"),t(24,"Vida:"),n(),i(25,"span",17),t(26),n(),t(27),n(),i(28,"li"),t(29,"\u{1F6E1}\uFE0F "),i(30,"span"),t(31,"Armadura:"),n(),t(32),n(),i(33,"li"),t(34,"\u{1F494} "),i(35,"span"),t(36,"Dano tomado:"),n(),t(37),n(),i(38,"li"),t(39,"\u2728 "),i(40,"span"),t(41,"Fator de cura:"),n(),t(42),n(),i(43,"li"),t(44,"\u{1F6B6}\u200D\u2642\uFE0F "),i(45,"span"),t(46,"Deslocamento:"),n(),t(47),n()(),i(48,"h6",18),t(49,"\u{1F4CA} Atributos"),n(),i(50,"div",19),M(51,Q,8,4,"div",20,q),n()()()),l&2){let a=j(4),o=u();r(2),s("ngIf",o.jogador.imagem&&o.jogador.imagem!=="-")("ngIfElse",a),r(5),d("\u{1F9D9} ",o.jogador.personagem),r(2),d("\u2696\uFE0F ",o.jogador.alinhamento||"Sem alinhamento"),r(6),d(" ",o.jogador.nivel),r(5),d(" ",o.jogador.xp),r(5),s("ngClass",k(13,X,o.jogador.vida_atual<=0)),r(),d(" ",o.jogador.vida_atual," "),r(),d(" / ",o.jogador.pontos_de_vida," "),r(5),d(" ",o.jogador.classe_de_armadura),r(5),d(" ",o.jogador.dano_tomado),r(5),d(" ",o.jogador.fator_cura),r(5),d(" ",o.jogador.deslocamento),r(4),J(o.atributos)}}function Y(l,e){l&1&&(i(0,"div",6),t(1,"Nenhum jogador encontrado. V\xE1 para o cadastro."),n())}var U=class l{constructor(e){this.router=e}jogador=null;atributos=[];loading=!0;imagemSelecionada=null;modalAberto=!1;repo=new B("Personagem");ngOnInit(){return f(this,null,function*(){console.log("[Jogador] Iniciando carregamento..."),this.loading=!0;try{let e=R.getUser();if(!e?.email)throw new Error("Usu\xE1rio n\xE3o autenticado.");let a=(yield this.repo.getLocal()).find(m=>m.email===e.email);if(a){console.log("[Jogador] Jogador local encontrado:",a),this.setJogador(a),this.repo.sync().then(m=>f(this,null,function*(){if(m){let g=(yield this.repo.getLocal()).find(c=>c.email===e.email);g&&this.setJogador(g)}}));return}console.log("[Jogador] Nenhum jogador local \u2192 carregando online..."),a=(yield this.repo.forceFetch()).find(m=>m.email===e.email),a?this.setJogador(a):(console.warn("[Jogador] Nenhum jogador encontrado nem online \u2192 cadastro"),this.router.navigate(["/cadastro-jogador"]))}catch(e){console.error("[Jogador] Erro ao carregar Jogador:",e),this.router.navigate(["/login"])}finally{this.loading=!1}})}setJogador(e){let a=e.pontos_de_vida&&e.pontos_de_vida>0?e.pontos_de_vida:(e.energia||0)+(e.constituicao||0),o=Math.floor((e.energia||0)/3),m=Math.floor((e.destreza||0)/3),g=(e.classe_de_armadura||0)>0?a:a-(e.dano_tomado||0);this.jogador=v(_({},e),{pontos_de_vida:a,vida_atual:g,fator_cura:o,deslocamento:m});let c=$=>Math.floor((($||0)-10)/2);this.atributos=[{label:"For\xE7a",value:e.forca,mod:c(e.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:e.destreza,mod:c(e.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:e.constituicao,mod:c(e.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:e.inteligencia,mod:c(e.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:e.sabedoria,mod:c(e.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:e.carisma,mod:c(e.carisma),icon:"\u{1F60E}"},{label:"Energia",value:e.energia,mod:c(e.energia),icon:"\u26A1"}]}editarJogador(){this.router.navigate(["/edicao-jogador"])}abrirImagem(e){this.imagemSelecionada=e,this.modalAberto=!0}static \u0275fac=function(a){return new(a||l)(E(V))};static \u0275cmp=S({type:l,selectors:[["app-jogador"]],decls:9,vars:3,consts:[["noImagem",""],[1,"jogador-detalhe-wrapper","d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","d-flex","justify-content-center"],[1,"jogador-detalhe-container","w-100"],[1,"text-center","py-5"],[1,"card","detalhe-card","shadow-lg","border-0"],[1,"alert","alert-warning","mt-4"],[1,"fab","fab-primary",3,"click"],[3,"fecharModal","imagem","aberto"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"position-relative"],[4,"ngIf","ngIfElse"],[1,"card-body","pb-5"],[1,"fw-bold","mb-1","text-light"],[1,"text-secondary","mb-3"],[1,"info-list","mb-3"],[3,"ngClass"],[1,"fw-bold","mt-3","text-light"],[1,"atributos-grid","compact","mb-3"],[1,"atributo-item"],["alt","Imagem do jogador",1,"card-img-top","detalhe-img",3,"click","src"],[1,"d-flex","align-items-center","justify-content-center","bg-secondary","text-dark","detalhe-img","fallback-icone"],[1,"text-light"]],template:function(a,o){a&1&&(i(0,"div",1)(1,"div",2)(2,"div",3),D(3,G,4,0,"div",4)(4,W,53,15,"div",5)(5,Y,2,0,"div",6),n()(),i(6,"button",7),p("click",function(){return o.editarJogador()}),t(7,"\u270F\uFE0F"),n()(),i(8,"app-image-modal",8),p("fecharModal",function(){return o.modalAberto=!1}),n()),a&2&&(r(3),I(o.loading?3:o.jogador?4:5),r(5),s("imagem",o.imagemSelecionada)("aberto",o.modalAberto))},dependencies:[N,T,A,L],styles:[".jogador-detalhe-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.jogador-detalhe-container[_ngcontent-%COMP%]{width:100%;max-width:900px;margin:0 auto}.detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{height:220px;object-fit:cover;width:100%}.fallback-icone[_ngcontent-%COMP%]{font-size:3rem}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:.95rem}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:#f1f1f1}.info-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px 14px;font-size:.9rem;color:#f1f1f1}.atributo-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.9rem;background:#2a2a2a;border-radius:6px;padding:6px 10px;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#ccc}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#f8f9fa}.fab[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;font-size:1.6rem;display:flex;align-items:center;justify-content:center;position:fixed;bottom:70px;right:20px;background:#0d6efd;color:#fff;box-shadow:0 4px 14px #0006;transition:transform .2s ease;border:none}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.08)}@media (min-width: 992px){.fab[_ngcontent-%COMP%]{right:calc(50% - 430px)}}"]})};export{U as Jogador};
