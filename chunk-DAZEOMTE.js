import{a as x}from"./chunk-TA2KEWZ6.js";import{c as N,f as T,g as z,h as B,i as W,j as R,k as L,m as q,n as U,o as G,p as H,q as X,r as Y}from"./chunk-2MTP6EBK.js";import"./chunk-MPFUFSQ6.js";import{f as J,g as F,j as A,s as I,v as K}from"./chunk-HRLERFBW.js";import{Db as C,Eb as v,Fb as f,Jb as p,Lb as s,Pa as j,Qa as c,Va as V,Vb as E,Zb as n,_b as b,ab as k,ac as P,cc as w,d as h,dc as y,ec as M,fb as _,fc as O,ia as m,ja as g,mc as D,wb as u,xb as e,yb as o,zb as S}from"./chunk-QQSIVCMV.js";function $(d,r){if(d&1){let t=f();C(0),S(1,"img",26),e(2,"button",27),p("click",function(){m(t);let i=s(2);return g(i.removerImagem())}),n(3,"\u2716"),o(),v()}if(d&2){let t=s(2);c(),u("src",t.jogador.imagem,j)}}function ee(d,r){if(d&1){let t=f();e(0,"label",28)(1,"span",29),n(2,"\u{1F4F7}"),o(),e(3,"input",30),p("change",function(i){m(t);let l=s(2);return g(l.onFileChange(i))}),o()()}}function te(d,r){if(d&1){let t=f();e(0,"div",31)(1,"div",32),n(2),o(),e(3,"div",33)(4,"button",34),p("click",function(){let i=m(t).$implicit,l=s(2);return g(l.ajustarValor(i.key,-1))}),n(5,"\u2212"),o(),e(6,"input",35),p("ngModelChange",function(i){let l=m(t).$implicit,Z=s(2);return g(Z.setValor(l.key,i))}),o(),e(7,"button",34),p("click",function(){let i=m(t).$implicit,l=s(2);return g(l.ajustarValor(i.key,1))}),n(8,"+"),o()()()}if(d&2){let t=r.$implicit,a=s(2);c(2),P(" ",t.icon," ",t.label," "),c(4),u("name",O(t.key))("ngModel",a.getValor(t.key))}}function ie(d,r){d&1&&(C(0),n(1,"\u{1F4BE} Atualizar"),v())}function oe(d,r){d&1&&(C(0),S(1,"span",36),n(2," Salvando... "),v())}function ne(d,r){if(d&1){let t=f();e(0,"form",5,0),p("ngSubmit",function(){m(t);let i=E(1),l=s();return g(l.salvar(i))}),e(2,"div",6),_(3,$,4,1,"ng-container",7)(4,ee,4,0,"ng-template",null,1,D),o(),e(6,"div",8)(7,"div",9)(8,"h4",10),n(9,"\u270F\uFE0F Edi\xE7\xE3o de Personagem"),o(),e(10,"div",11)(11,"label",12),n(12,"\u{1F9D9} Nome do Personagem *"),o(),e(13,"input",13),M("ngModelChange",function(i){m(t);let l=s();return y(l.jogador.personagem,i)||(l.jogador.personagem=i),g(i)}),o()(),e(14,"div",11)(15,"label",12),n(16,"\u2696\uFE0F Alinhamento *"),o(),e(17,"select",14),M("ngModelChange",function(i){m(t);let l=s();return y(l.jogador.alinhamento,i)||(l.jogador.alinhamento=i),g(i)}),e(18,"option",15),n(19,"Selecione..."),o(),e(20,"option"),n(21,"Leal e Bom"),o(),e(22,"option"),n(23,"Neutro"),o(),e(24,"option"),n(25,"Ca\xF3tico e Bom"),o(),e(26,"option"),n(27,"Ca\xF3tico e Mau"),o()()(),e(28,"div",11)(29,"label",12),n(30,"\u{1F3AD} Tipo de Jogador *"),o(),e(31,"select",16),M("ngModelChange",function(i){m(t);let l=s();return y(l.jogador.tipo_jogador,i)||(l.jogador.tipo_jogador=i),g(i)}),e(32,"option",15),n(33,"Selecione..."),o(),e(34,"option"),n(35,"Aventureiro"),o(),e(36,"option"),n(37,"Mestre"),o()()(),e(38,"h6",17),n(39,"\u{1F4CA} Atributos Num\xE9ricos"),o(),e(40,"div",18),_(41,te,9,5,"div",19),o(),e(42,"h6",17),n(43,"\u2694\uFE0F Atributos Calculados"),o(),e(44,"div",20)(45,"div",21)(46,"span"),n(47,"\u2764\uFE0F Vida"),o(),e(48,"b"),n(49),o(),e(50,"small"),n(51,"(Energia + Constitui\xE7\xE3o)"),o()(),e(52,"div",21)(53,"span"),n(54,"\u{1F496} Vida Total"),o(),e(55,"b"),n(56),o(),e(57,"small"),n(58,"(Vida + Armadura)"),o()(),e(59,"div",21)(60,"span"),n(61,"\u2728 Fator de Cura"),o(),e(62,"b"),n(63),o(),e(64,"small"),n(65,"(Energia / 3)"),o()(),e(66,"div",21)(67,"span"),n(68,"\u{1F3C3} Deslocamento"),o(),e(69,"b"),n(70),o(),e(71,"small"),n(72,"(Destreza / 3)"),o()()(),e(73,"div",22)(74,"button",23),p("click",function(){m(t);let i=s();return g(i.cancelar())}),n(75,"\u2B05 Cancelar"),o(),e(76,"button",24),_(77,ie,2,0,"ng-container",25)(78,oe,3,0,"ng-container",25),o()()()()()}if(d&2){let t=E(1),a=E(5),i=s();c(3),u("ngIf",i.jogador.imagem)("ngIfElse",a),c(10),w("ngModel",i.jogador.personagem),c(4),w("ngModel",i.jogador.alinhamento),c(14),w("ngModel",i.jogador.tipo_jogador),c(10),u("ngForOf",i.atributosNumericos),c(8),b(i.vida),c(7),b(i.vidaTotal),c(7),b(i.fatorCura),c(7),b(i.deslocamento),c(6),u("disabled",t.invalid||i.salvando),c(),u("ngIf",!i.salvando),c(),u("ngIf",i.salvando)}}var Q=class d{constructor(r){this.router=r}jogador=null;salvando=!1;atributosNumericos=[{key:"nivel",label:"N\xEDvel",icon:"\u{1F3C5}"},{key:"xp",label:"XP",icon:"\u2B50"},{key:"forca",label:"For\xE7a",icon:"\u{1F4AA}"},{key:"destreza",label:"Destreza",icon:"\u{1F3C3}"},{key:"constituicao",label:"Constitui\xE7\xE3o",icon:"\u{1FAA8}"},{key:"inteligencia",label:"Intelig\xEAncia",icon:"\u{1F9E0}"},{key:"sabedoria",label:"Sabedoria",icon:"\u{1F4D6}"},{key:"carisma",label:"Carisma",icon:"\u{1F60E}"},{key:"energia",label:"Energia",icon:"\u26A1"},{key:"classe_de_armadura",label:"Armadura",icon:"\u{1F6E1}\uFE0F"}];get vida(){return this.jogador?this.jogador.energia+this.jogador.constituicao:0}get vidaTotal(){return this.jogador?this.vida+this.jogador.classe_de_armadura:0}get fatorCura(){return this.jogador?Math.floor(this.jogador.energia/3):0}get deslocamento(){return this.jogador?Math.floor(this.jogador.destreza/3):0}getValor(r){return this.jogador?this.jogador[r]:0}setValor(r,t){this.jogador&&(this.jogador[r]=Math.max(0,t))}ajustarValor(r,t){this.setValor(r,this.getValor(r)+t)}onFileChange(r){let t=r.target;if(t.files&&t.files.length>0&&this.jogador){let a=t.files[0],i=new FileReader;i.onload=()=>{this.jogador&&(this.jogador.imagem=i.result)},i.readAsDataURL(a)}}removerImagem(){this.jogador&&(this.jogador.imagem="")}salvar(r){return h(this,null,function*(){if(!(r.invalid||!this.jogador))try{this.salvando=!0;let t=K.getUser();if(!t?.email)throw new Error("Usu\xE1rio n\xE3o autenticado");this.jogador.email=t.email,yield x.updateJogador(this.jogador),window.alert("\u2705 Jogador atualizado com sucesso!"),this.router.navigate(["/jogador"])}catch(t){console.error("[EdicaoJogador] Erro ao salvar:",t),window.alert("\u274C Erro ao salvar jogador. Veja o console.")}finally{this.salvando=!1}})}ngOnInit(){return h(this,null,function*(){try{let r=yield x.getCurrentJogador();if(!r){window.alert("Nenhum jogador encontrado. V\xE1 para o cadastro primeiro."),this.router.navigate(["/cadastro-jogador"]);return}this.jogador=r,x.syncJogadores().then(t=>h(this,null,function*(){if(t){let a=yield x.getCurrentJogador();a&&(this.jogador=a)}}))}catch(r){console.error("[EdicaoJogador] Erro ao carregar jogador:",r),this.router.navigate(["/login"])}})}cancelar(){this.router.navigate(["/jogador"])}static \u0275fac=function(t){return new(t||d)(V(I))};static \u0275cmp=k({type:d,selectors:[["app-edicao-jogador"]],decls:3,vars:1,consts:[["form","ngForm"],["uploadBox",""],[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","pb-5"],[3,"ngSubmit",4,"ngIf"],[3,"ngSubmit"],[1,"position-relative","text-center","mb-3"],[4,"ngIf","ngIfElse"],[1,"card","detalhe-card","shadow-lg","border-0"],[1,"card-body"],[1,"fw-bold","mb-3","text-light"],[1,"mb-3"],[1,"form-label","text-light"],["type","text","name","personagem","required","",1,"form-control","input-dark",3,"ngModelChange","ngModel"],["name","alinhamento","required","",1,"form-select","input-dark",3,"ngModelChange","ngModel"],["value","","disabled",""],["name","tipoJogador","required","",1,"form-select","input-dark",3,"ngModelChange","ngModel"],[1,"fw-bold","mt-4","text-light"],[1,"atributos-grid-edit","mb-3"],["class","atributo-item-edit",4,"ngFor","ngForOf"],[1,"atributos-grid","mb-3"],[1,"atributo-item"],[1,"d-flex","justify-content-between","mt-4"],["type","button",1,"btn","btn-outline-light","w-45",3,"click"],["type","submit",1,"btn","btn-save","w-45",3,"disabled"],[4,"ngIf"],["alt","Preview",1,"w-100","rounded","detalhe-img","shadow-sm",3,"src"],["type","button",1,"btn","btn-danger","rounded-circle","position-absolute","d-flex","align-items-center","justify-content-center",2,"top","10px","right","10px","width","40px","height","40px",3,"click"],[1,"upload-box"],[1,"fs-1"],["type","file","accept","image/*",1,"d-none",3,"change"],[1,"atributo-item-edit"],[1,"atributo-label","text-center"],[1,"atributo-controls"],["type","button",1,"btn","btn-sm","btn-outline-light",3,"click"],["type","number","min","0",1,"atributo-input",3,"ngModelChange","ngModel","name"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(t,a){t&1&&(e(0,"div",2)(1,"div",3),_(2,ne,79,13,"form",4),o()()),t&2&&(c(2),u("ngIf",a.jogador))},dependencies:[A,J,F,Y,R,U,G,N,L,q,T,z,X,H,W,B],styles:[".detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{height:200px;object-fit:cover;border-radius:8px}.upload-box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border:2px dashed #444;border-radius:12px;width:100%;height:140px;background:#1e1e1e;color:#6c757d;cursor:pointer;transition:border .2s ease,color .2s ease}.upload-box[_ngcontent-%COMP%]:hover{border-color:#0d6efd;color:#0d6efd}.input-dark[_ngcontent-%COMP%]{background:#1e1e1e;border:1px solid #444;color:#f8f9fa}.input-dark[_ngcontent-%COMP%]:focus{border-color:#0d6efd;box-shadow:0 0 0 .2rem #0d6efd40;outline:none}.atributos-grid-edit[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}@media (min-width: 768px){.atributos-grid-edit[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (min-width: 992px){.atributos-grid-edit[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.atributo-item-edit[_ngcontent-%COMP%]{background:#2a2a2a;border-radius:6px;padding:8px 10px;display:flex;flex-direction:column;align-items:center}.atributo-label[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa;margin-bottom:6px;text-align:center}.atributo-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:6px}.atributo-input[_ngcontent-%COMP%]{width:60px;text-align:center;font-weight:700;color:#fff;background:#1e1e1e;border:1px solid #444;border-radius:4px;padding:2px 4px}.atributo-input[_ngcontent-%COMP%]:focus{border-color:#0d6efd;outline:none;box-shadow:0 0 0 .2rem #0d6efd40}.atributo-controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:2px 8px;font-size:.9rem;line-height:1}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}@media (min-width: 768px){.atributos-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (min-width: 992px){.atributos-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.atributo-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#2a2a2a;border-radius:6px;padding:6px 10px;text-align:center}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.75rem;color:#aaa}.btn-save[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#218838);border:none;color:#fff;font-weight:600;display:flex;align-items:center;justify-content:center;gap:6px;transition:all .2s ease-in-out}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#34d058,#28a745);transform:translateY(-2px);box-shadow:0 4px 10px #0000004d}.btn-save[_ngcontent-%COMP%]:disabled{background:#444!important;color:#bbb!important;cursor:not-allowed;box-shadow:none}.btn-save[_ngcontent-%COMP%]{margin-left:auto}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#f8f9fa!important}"]})};export{Q as EdicaoJogador};
