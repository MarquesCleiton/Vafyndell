import{a as f}from"./chunk-HXJSPHLL.js";import{c as j,f as R,i as V,r as $}from"./chunk-2MTP6EBK.js";import"./chunk-2P6BNU5L.js";import{f as T,g as z,j as L,s as N}from"./chunk-HRLERFBW.js";import{$b as _,Fb as b,Jb as p,Lb as d,Pa as w,Qa as o,Va as M,Yb as O,Zb as s,_b as u,a as I,ab as S,b as y,cc as D,d as x,dc as E,ec as P,fb as m,fc as F,gc as k,ia as v,ja as h,wb as c,xb as a,yb as r,zb as C}from"./chunk-QQSIVCMV.js";function B(i,e){i&1&&(a(0,"div",10),C(1,"div",11),a(2,"p",12),s(3,"Carregando cat\xE1logo..."),r()())}function W(i,e){i&1&&(a(0,"div",13),s(1," Nenhum item encontrado. "),r())}function q(i,e){if(i&1&&C(0,"img",31),i&2){let t=d().$implicit;c("alt",F(t.nome||"Item"))("src",t.imagem,w)}}function U(i,e){i&1&&(a(0,"span",32),s(1,"\u{1F4E6}"),r())}function Y(i,e){if(i&1&&(a(0,"p",33),s(1),r()),i&2){let t=d().$implicit;o(),_(" \u2728 ",t.efeito," ")}}function G(i,e){if(i&1&&(a(0,"p",34),s(1),r()),i&2){let t=d().$implicit;o(),_(" \u26A0\uFE0F ",t.colateral," ")}}function H(i,e){if(i&1&&(a(0,"p",35),s(1),r()),i&2){let t=d().$implicit;o(),_(" \u{1F4DD} ",t.descricao," ")}}function J(i,e){if(i&1){let t=b();a(0,"div",21)(1,"div",22),p("click",function(){let l=v(t).$implicit,g=d(4);return h(g.abrirItem(l))}),a(2,"div",23)(3,"div",24),m(4,q,1,3,"img",25)(5,U,2,0,"span",26),r(),a(6,"div")(7,"h6",27),s(8),r(),a(9,"small"),s(10),r()()(),m(11,Y,2,1,"p",28)(12,G,2,1,"p",29)(13,H,2,1,"p",30),r()()}if(i&2){let t=e.$implicit,n=d(4);o(4),c("ngIf",t.imagem),o(),c("ngIf",!t.imagem),o(3),u(t.nome||"Sem nome"),o(),O(k("raridade ",n.getRaridadeClass(t.raridade))),o(),_(" ",t.raridade||"Comum"," "),o(),c("ngIf",t.efeito),o(),c("ngIf",t.colateral),o(),c("ngIf",t.descricao)}}function K(i,e){if(i&1&&(a(0,"div",12)(1,"div",19),m(2,J,14,10,"div",20),r()()),i&2){let t=d().$implicit;o(2),c("ngForOf",t.itens)}}function Q(i,e){if(i&1){let t=b();a(0,"div",15)(1,"button",16),p("click",function(){let l=v(t).$implicit,g=d(2);return h(g.toggleCategoria(l))}),a(2,"span",17),s(3),r(),a(4,"span"),s(5),r()(),m(6,K,3,1,"div",18),r()}if(i&2){let t=e.$implicit;o(3),u(t.nome||"Outros"),o(2),u(t.expandido?"\u2212":"+"),o(),c("ngIf",t.expandido)}}function X(i,e){if(i&1&&(a(0,"div"),m(1,Q,7,3,"div",14),r()),i&2){let t=d();o(),c("ngForOf",t.categoriasFiltradas)}}var A=class i{constructor(e){this.router=e}categorias=[];categoriasFiltradas=[];carregando=!0;filtro="";ngOnInit(){return x(this,null,function*(){try{console.log("[Catalogo] Iniciando carregamento..."),this.carregando=!0;let e=yield f.getLocalItens();if(e.length&&(console.log("[Catalogo] Itens locais encontrados:",e.length),this.processarItens(e),this.carregando=!1),f.syncItens().then(t=>x(this,null,function*(){if(t){console.log("[Catalogo] Sync trouxe altera\xE7\xF5es. Recarregando...");let n=yield f.getLocalItens();this.processarItens(n)}})),!e.length){console.log("[Catalogo] Nenhum item local. Buscando online...");let t=yield f.forceFetchItens();this.processarItens(t),this.carregando=!1}}catch(e){console.error("[Catalogo] Erro ao carregar itens:",e),this.carregando=!1}})}aplicarFiltro(){let e=this.filtro.toLowerCase();if(!e){this.categoriasFiltradas=[...this.categorias];return}this.categoriasFiltradas=this.categorias.map(t=>y(I({},t),{itens:t.itens.filter(n=>String(n.nome||"").toLowerCase().includes(e)||String(n.raridade||"").toLowerCase().includes(e)||String(n.efeito||"").toLowerCase().includes(e)||String(n.colateral||"").toLowerCase().includes(e)||String(n.categoria||"").toLowerCase().includes(e))})).filter(t=>t.itens.length>0)}abrirItem(e){this.router.navigate(["/item-catalogo",e.id])}processarItens(e){let t=new Map;e.forEach(n=>{let l=n.categoria||"Outros";t.has(l)||t.set(l,[]),t.get(l).push(n)}),this.categorias=Array.from(t.entries()).sort((n,l)=>String(n[0]).localeCompare(String(l[0]))).map(([n,l])=>({nome:String(n||"Outros"),itens:l,expandido:!1})),this.categoriasFiltradas=[...this.categorias]}toggleCategoria(e){e.expandido=!e.expandido}novoItem(){this.router.navigate(["/cadastro-item-catalogo"])}getRaridadeClass(e){return e?String(e).toLowerCase():"comum"}static \u0275fac=function(t){return new(t||i)(M(N))};static \u0275cmp=S({type:i,selectors:[["app-catalogo"]],decls:12,vars:4,consts:[[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"p-3","bg-black","border-bottom","position-sticky","top-0",2,"z-index","10"],["type","text","placeholder","\u{1F50D} Pesquisar no cat\xE1logo...",1,"form-control","bg-dark","text-light","border-light","rounded-pill","px-3",3,"ngModelChange","input","ngModel"],[1,"flex-grow-1","p-3"],[1,"fw-bold","mb-3"],["class","text-center py-5",4,"ngIf"],["class","text-center text-muted py-5",4,"ngIf"],[4,"ngIf"],[1,"fab","btn","btn-primary","rounded-circle","shadow-lg",3,"click"],[1,"fs-4"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"text-center","text-muted","py-5"],["class","mb-3",4,"ngFor","ngForOf"],[1,"mb-3"],[1,"btn","btn-outline-light","w-100","text-start","d-flex","justify-content-between","align-items-center",3,"click"],[1,"fw-bold"],["class","mt-2",4,"ngIf"],[1,"row","row-cols-1","g-2"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[1,"card","catalogo-card","shadow-sm","h-100","p-3",2,"cursor","pointer",3,"click"],[1,"d-flex","align-items-center","mb-2"],[1,"rounded","me-3","d-flex","align-items-center","justify-content-center","bg-dark",2,"width","55px","height","55px","overflow","hidden"],["style","width: 100%; height: 100%; object-fit: cover;",3,"src","alt",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"fw-bold","text-white","mb-1"],["class","small mt-2 text-info",4,"ngIf"],["class","small text-danger",4,"ngIf"],["class","small descricao-text fst-italic",4,"ngIf"],[2,"width","100%","height","100%","object-fit","cover",3,"src","alt"],[1,"text-muted"],[1,"small","mt-2","text-info"],[1,"small","text-danger"],[1,"small","descricao-text","fst-italic"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"input",2),P("ngModelChange",function(g){return E(n.filtro,g)||(n.filtro=g),g}),p("input",function(){return n.aplicarFiltro()}),r()(),a(3,"div",3)(4,"h4",4),s(5,"\u{1F4DA} Cat\xE1logo"),r(),m(6,B,4,0,"div",5)(7,W,2,0,"div",6)(8,X,2,1,"div",7),r(),a(9,"button",8),p("click",function(){return n.novoItem()}),a(10,"span",9),s(11,"\uFF0B"),r()()()),t&2&&(o(2),D("ngModel",n.filtro),o(4),c("ngIf",n.carregando),o(),c("ngIf",!n.carregando&&n.categoriasFiltradas.length===0),o(),c("ngIf",!n.carregando))},dependencies:[L,T,z,$,j,R,V],styles:["[_ngcontent-%COMP%]:root{--header-height: 56px;--bottom-nav-height: 56px;--search-height: 56px}.categoria-header[_ngcontent-%COMP%]{position:sticky;top:var(--header-height);z-index:10;background-color:#2c2c2c;padding:6px 12px;font-size:.95rem;font-weight:600;letter-spacing:.5px;border-radius:6px}.search-bar-bottom[_ngcontent-%COMP%]{position:fixed;bottom:var(--bottom-nav-height);left:0;right:0;z-index:1100;background:#212529;min-height:var(--search-height);display:flex;align-items:center}.flex-grow-1[_ngcontent-%COMP%]{padding-bottom:calc(var(--search-height) + var(--bottom-nav-height) + 1rem)}.fab[_ngcontent-%COMP%]{position:fixed;bottom:calc(var(--bottom-nav-height) + var(--search-height) + 20px);right:20px;width:56px;height:56px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;z-index:1200;background:#0d6efd;border:none;transition:all .2s ease-in-out}.toggle-icon[_ngcontent-%COMP%]{font-size:1rem;cursor:pointer;transition:transform .2s}.toggle-icon[_ngcontent-%COMP%]:hover{transform:scale(1.15)}.catalogo-card[_ngcontent-%COMP%]{background:#1e1e1e;border:1px solid #333;border-radius:14px;transition:all .2s ease-in-out}.catalogo-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 6px 14px #00000073}.efeito-text[_ngcontent-%COMP%]{color:#e6e6e6!important}.descricao-text[_ngcontent-%COMP%]{color:#cfcfcf!important}.text-light[_ngcontent-%COMP%]{color:#f0f0f0!important}.text-muted[_ngcontent-%COMP%]{color:#b8b8b8!important}.raridade.comum[_ngcontent-%COMP%]{color:#999}.raridade.incomum[_ngcontent-%COMP%]{color:#6fbf73}.raridade.raro[_ngcontent-%COMP%]{color:#4a90e2}.raridade.\\e9pico[_ngcontent-%COMP%]{color:#9b7ecb}.raridade.lend\\e1rio[_ngcontent-%COMP%]{color:#d4af37}.colateral[_ngcontent-%COMP%]{color:#c97a7a!important}.fab[_ngcontent-%COMP%]{position:fixed;bottom:80px;right:20px;width:56px;height:56px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;z-index:100;background:#0d6efd;border:none;transition:all .2s ease-in-out}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.1);background:#0b5ed7}"]})};export{A as Catalogo};
