import{a as m}from"./chunk-G46V626D.js";import"./chunk-W7DVKRY2.js";import"./chunk-HS244SCX.js";import{Ga as d,Gb as P,Ha as t,Ia as n,Ja as u,Jb as M,Mb as O,Na as I,Oa as y,Pa as F,Ra as b,S as v,T as _,Ta as p,Tb as A,Vb as T,a as f,d as g,fb as i,gb as l,ha as C,hb as x,ia as a,ma as h,nb as w,qa as N,ua as E}from"./chunk-ILJPX4RU.js";function j(r,o){r&1&&(t(0,"div",5),u(1,"div",6),t(2,"p",7),i(3,"Carregando NPC..."),n()())}function R(r,o){if(r&1&&(I(0),u(1,"img",18),y()),r&2){let e=p(2);a(),d("alt",w(e.npc.nome))("src",e.npc.imagem,C)}}function q(r,o){if(r&1&&(t(0,"p",19),i(1),n()),r&2){let e=p(2);a(),x(" ",e.npc.descricao," ")}}function z(r,o){if(r&1&&(t(0,"div")(1,"h6",20),i(2,"\u2694\uFE0F Ataques"),n(),t(3,"p",21),i(4),n()()),r&2){let e=p(2);a(4),l(e.npc.ataques)}}function L(r,o){if(r&1){let e=F();t(0,"div",8),E(1,R,2,3,"ng-container",9),t(2,"div",10)(3,"h4",11),i(4),n(),t(5,"p",12)(6,"b"),i(7,"\u{1F3F7}\uFE0F Classifica\xE7\xE3o:"),n(),i(8),n(),t(9,"p",12)(10,"b"),i(11,"\u{1F3AD} Tipo:"),n(),i(12),n(),t(13,"p",12)(14,"b"),i(15,"\u2696\uFE0F Alinhamento:"),n(),i(16),n(),u(17,"hr"),t(18,"p"),i(19,"\u2764\uFE0F Vida: "),t(20,"b"),i(21),n()(),t(22,"p"),i(23,"\u{1F6E1}\uFE0F Armadura: "),t(24,"b"),i(25),n()(),t(26,"p"),i(27,"\u2B50 XP: "),t(28,"b"),i(29),n()(),t(30,"p"),i(31,"\u{1F4AA} For\xE7a: "),t(32,"b"),i(33),n()(),t(34,"p"),i(35,"\u{1FAA8} Constitui\xE7\xE3o: "),t(36,"b"),i(37),n()(),t(38,"p"),i(39,"\u{1F938}\u200D\u2642\uFE0F Destreza: "),t(40,"b"),i(41),n()(),t(42,"p"),i(43,"\u{1F4D6} Sabedoria: "),t(44,"b"),i(45),n()(),t(46,"p"),i(47,"\u{1F9E0} Intelig\xEAncia: "),t(48,"b"),i(49),n()(),t(50,"p"),i(51,"\u26A1 Energia: "),t(52,"b"),i(53),n()(),u(54,"hr"),E(55,q,2,1,"p",13)(56,z,5,1,"div",9),t(57,"div",14)(58,"button",15),b("click",function(){v(e);let s=p();return _(s.cancelar())}),i(59,"\u2B05 Voltar"),n(),t(60,"div")(61,"button",16),b("click",function(){v(e);let s=p();return _(s.editarNpc())}),i(62," \u270F\uFE0F Editar "),n(),t(63,"button",17),b("click",function(){v(e);let s=p();return _(s.excluirNpc())}),i(64," \u{1F5D1}\uFE0F Excluir "),n()()()()()}if(r&2){let e=p();a(),d("ngIf",e.npc.imagem),a(3),l(e.npc.nome),a(4),x(" ",e.npc.classificacao),a(4),x(" ",e.npc.tipo),a(4),x(" ",e.npc.alinhamento||"N\xE3o definido"),a(5),l(e.npc.pontos_de_vida),a(4),l(e.npc.classe_armadura),a(4),l(e.npc.xp),a(4),l(e.npc.forca),a(4),l(e.npc.constituicao),a(4),l(e.npc.destreza),a(4),l(e.npc.sabedoria),a(4),l(e.npc.inteligencia),a(4),l(e.npc.energia),a(2),d("ngIf",e.npc.descricao),a(),d("ngIf",e.npc.ataques),a(5),d("disabled",e.processandoEditar),a(2),d("disabled",e.processandoExcluir)}}function B(r,o){r&1&&(t(0,"div",22),i(1," NPC n\xE3o encontrado. "),n())}var k=class r{constructor(o,e,c){this.route=o;this.router=e;this.location=c}npc=null;carregando=!0;processandoEditar=!1;processandoExcluir=!1;ngOnInit(){return g(this,null,function*(){let o=this.route.snapshot.paramMap.get("id");if(!o){this.router.navigate(["/npcs"]);return}try{this.carregando=!0;let c=(yield m.getLocalNpcs()).find(s=>String(s.id)===String(o))||null;c&&(this.npc=f({},c)),m.syncNpcs().then(s=>g(this,null,function*(){if(s){let S=(yield m.getLocalNpcs()).find(V=>String(V.id)===String(o));S&&(this.npc=f({},S))}})),c||(c=(yield m.forceFetchNpcs()).find(D=>String(D.id)===String(o))||null,c&&(this.npc=f({},c)))}catch(e){console.error("[NpcDetalhes] Erro ao carregar NPC:",e)}finally{this.carregando=!1}})}cancelar(){this.location.back()}editarNpc(){this.npc&&(this.processandoEditar=!0,setTimeout(()=>{this.router.navigate(["/cadastro-npc",this.npc.id],{queryParams:{returnUrl:this.router.url}}),this.processandoEditar=!1},300))}excluirNpc(){return g(this,null,function*(){if(!(!this.npc||!confirm(`\u{1F5D1}\uFE0F Deseja realmente excluir "${this.npc.nome}"?`))){this.processandoExcluir=!0;try{yield m.deleteNpc(this.npc.id),alert("\u2705 NPC exclu\xEDdo com sucesso!"),this.router.navigate(["/npcs"])}catch(e){console.error("[NpcDetalhes] Erro ao excluir NPC:",e),alert("\u274C Erro ao excluir NPC. Veja o console.")}finally{this.processandoExcluir=!1}}})}static \u0275fac=function(e){return new(e||r)(h(A),h(T),h(P))};static \u0275cmp=N({type:r,selectors:[["app-npc-detalhes"]],decls:5,vars:3,consts:[[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","p-3"],["class","text-center py-5",4,"ngIf"],["class","card bg-secondary text-light shadow-lg border-0",4,"ngIf"],["class","text-center text-muted py-5",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"card","bg-secondary","text-light","shadow-lg","border-0"],[4,"ngIf"],[1,"card-body"],[1,"fw-bold"],[1,"mb-1"],["class","descricao-text",4,"ngIf"],[1,"d-flex","justify-content-between","mt-4"],[1,"btn","btn-outline-light",3,"click"],[1,"btn","btn-warning","me-2",3,"click","disabled"],[1,"btn","btn-danger",3,"click","disabled"],[1,"card-img-top","object-fit-cover",2,"max-height","300px",3,"src","alt"],[1,"descricao-text"],[1,"fw-bold","mt-3"],[1,"ataques-text"],[1,"text-center","text-muted","py-5"]],template:function(e,c){e&1&&(t(0,"div",0)(1,"div",1),E(2,j,4,0,"div",2)(3,L,65,18,"div",3)(4,B,2,0,"div",4),n()()),e&2&&(a(2),d("ngIf",c.carregando),a(),d("ngIf",!c.carregando&&c.npc),a(),d("ngIf",!c.carregando&&!c.npc))},dependencies:[O,M],styles:[".card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;border-bottom:3px solid #444}h4[_ngcontent-%COMP%]{color:#fff;margin-bottom:.5rem}p[_ngcontent-%COMP%]{color:#ddd;margin-bottom:.3rem}hr[_ngcontent-%COMP%]{opacity:.3;margin:1rem 0}button[_ngcontent-%COMP%]{font-weight:500;border-radius:8px;transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.descricao-text[_ngcontent-%COMP%], .ataques-text[_ngcontent-%COMP%]{white-space:pre-line}"]})};export{k as NpcDetalhes};
