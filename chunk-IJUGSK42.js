import{a as T}from"./chunk-34ZGBLOX.js";import{e as J,f as B,g as F,j,q as k,s as z}from"./chunk-S65SB5BW.js";import{$b as s,Db as I,Eb as y,Jb as S,Lb as p,Pa as D,Qa as l,Va as _,Vb as M,Zb as t,_b as u,a as b,ab as E,ac as O,b as C,d as h,fb as g,ic as w,mc as P,wb as c,xb as a,yb as n,zb as v}from"./chunk-QQSIVCMV.js";var A=o=>({"text-danger fw-bold":o});function R(o,e){o&1&&(a(0,"div",9),v(1,"div",10),a(2,"p",11),t(3,"Carregando personagem..."),n()())}function N(o,e){if(o&1&&(I(0),v(1,"img",24),y()),o&2){let i=p(2);l(),c("src",i.jogador.imagem,D)}}function U(o,e){o&1&&(a(0,"div",25),t(1," \u{1F464} "),n())}function L(o,e){if(o&1&&(a(0,"div",26),t(1),a(2,"span"),t(3),n(),a(4,"b"),t(5),n(),a(6,"small",27),t(7),n()()),o&2){let i=e.$implicit;l(),s(" ",i.icon," "),l(2),u(i.label),l(2),u(i.value),l(2),s("(",i.mod>=0?"+"+i.mod:i.mod,")")}}function V(o,e){if(o&1&&(a(0,"p",33),t(1),n()),o&2){let i=p(3);l(),u(i.jogador.descricao)}}function X(o,e){o&1&&(a(0,"h6",34),t(1,"\u2694\uFE0F Ataques"),n())}function $(o,e){if(o&1&&(a(0,"p",35),t(1),n()),o&2){let i=p(3);l(),u(i.jogador.ataques)}}function G(o,e){if(o&1&&(a(0,"div",28)(1,"h6",29),t(2,"\u{1F4DD} Descri\xE7\xE3o"),n(),g(3,V,2,1,"p",30)(4,X,2,0,"h6",31)(5,$,2,1,"p",32),n()),o&2){let i=p(2);l(3),c("ngIf",i.jogador.descricao),l(),c("ngIf",i.jogador.ataques),l(),c("ngIf",i.jogador.ataques)}}function H(o,e){if(o&1&&(a(0,"div",12)(1,"div",13),g(2,N,2,1,"ng-container",14)(3,U,2,0,"ng-template",null,0,P),n(),a(5,"div",15)(6,"h4",16),t(7),n(),a(8,"p",17),t(9),n(),a(10,"ul",18)(11,"li"),t(12,"\u2B50 "),a(13,"span"),t(14,"XP:"),n(),t(15),n(),a(16,"li"),t(17," \u2764\uFE0F "),a(18,"span"),t(19,"Vida:"),n(),a(20,"span",19),t(21),n(),t(22),n(),a(23,"li"),t(24,"\u{1F6E1}\uFE0F "),a(25,"span"),t(26,"Armadura:"),n(),t(27),n(),a(28,"li"),t(29,"\u{1F494} "),a(30,"span"),t(31,"Dano tomado:"),n(),t(32),n(),a(33,"li"),t(34,"\u2728 "),a(35,"span"),t(36,"Fator de cura:"),n(),t(37),n(),a(38,"li"),t(39,"\u{1F6B6}\u200D\u2642\uFE0F "),a(40,"span"),t(41,"Deslocamento:"),n(),t(42),n()(),a(43,"h6",20),t(44,"\u{1F4CA} Atributos"),n(),a(45,"div",21),g(46,L,8,4,"div",22),n(),g(47,G,6,3,"div",23),n()()),o&2){let i=M(4),r=p();l(2),c("ngIf",r.jogador.imagem&&r.jogador.imagem!=="-")("ngIfElse",i),l(5),O(" ",r.jogador.email?"\u{1F9D9}":"\u{1F479}"," ",r.jogador.personagem," "),l(2),s(" \u2696\uFE0F ",r.jogador.alinhamento||"Sem alinhamento"," "),l(6),s(" ",r.jogador.xp),l(5),c("ngClass",w(15,A,r.jogador.vida_atual<=0)),l(),s(" ",r.jogador.vida_atual," "),l(),s(" / ",r.jogador.pontos_de_vida," "),l(5),s(" ",r.jogador.classe_de_armadura),l(5),s(" ",r.jogador.dano_tomado),l(5),s(" ",r.jogador.fator_cura),l(5),s(" ",r.jogador.deslocamento),l(4),c("ngForOf",r.atributos),l(),c("ngIf",!r.jogador.email)}}function K(o,e){o&1&&(a(0,"div",36),t(1," Nenhum personagem encontrado. "),n())}var q=class o{constructor(e,i){this.route=e;this.router=i}jogador=null;atributos=[];loading=!0;repo=new T("Personagem");ngOnInit(){return h(this,null,function*(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.router.navigate(["/batalha"]);return}try{let r=(yield this.repo.getLocal()).find(m=>String(m.id)===String(e));if(r)this.setJogador(r),this.repo.sync().then(m=>h(this,null,function*(){if(m){let d=(yield this.repo.getLocal()).find(x=>String(x.id)===String(e));d&&this.setJogador(d)}}));else{let f=(yield this.repo.forceFetch()).find(d=>String(d.id)===String(e));f&&this.setJogador(f)}}catch(i){console.error("[JogadorDetalhesBatalha] Erro:",i)}finally{this.loading=!1}})}setJogador(e){let i=e.pontos_de_vida&&e.pontos_de_vida>0?e.pontos_de_vida:e.energia+e.constituicao,r=Math.floor(e.energia/3),m=Math.floor(e.destreza/3),f=e.classe_de_armadura>0?i:i-(e.dano_tomado||0);this.jogador=C(b({},e),{pontos_de_vida:i,vida_atual:f,fator_cura:r,deslocamento:m});let d=x=>Math.floor((x-10)/2);this.atributos=[{label:"For\xE7a",value:e.forca,mod:d(e.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:e.destreza,mod:d(e.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:e.constituicao,mod:d(e.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:e.inteligencia,mod:d(e.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:e.sabedoria,mod:d(e.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:e.carisma,mod:d(e.carisma),icon:"\u{1F60E}"},{label:"Energia",value:e.energia,mod:d(e.energia),icon:"\u26A1"}]}editarJogador(){this.jogador&&(this.jogador.email?this.router.navigate(["/cadastro-jogador",this.jogador.id],{queryParams:{returnUrl:this.router.url}}):this.router.navigate(["/cadastro-npc",this.jogador.id],{queryParams:{returnUrl:this.router.url}}))}voltarBatalha(){this.router.navigate(["/batalha"])}static \u0275fac=function(i){return new(i||o)(_(k),_(z))};static \u0275cmp=E({type:o,selectors:[["app-jogador-detalhes-batalha"]],decls:9,vars:3,consts:[["noImagem",""],[1,"personagem-detalhe-wrapper","d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","d-flex","justify-content-center"],[1,"personagem-detalhe-container","w-100"],["class","text-center py-5",4,"ngIf"],["class","card detalhe-card shadow-lg border-0",4,"ngIf"],["class","alert alert-warning mt-4",4,"ngIf"],[1,"fab-stack"],[1,"fab","fab-primary",3,"click"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"card","detalhe-card","shadow-lg","border-0"],[1,"position-relative"],[4,"ngIf","ngIfElse"],[1,"card-body","pb-5"],[1,"fw-bold","mb-1","text-light"],[1,"text-secondary","mb-3"],[1,"info-list","mb-3"],[3,"ngClass"],[1,"fw-bold","mt-3","text-light"],[1,"atributos-grid","compact","mb-3"],["class","atributo-item",4,"ngFor","ngForOf"],["class","mt-3",4,"ngIf"],["alt","Imagem do personagem",1,"card-img-top","detalhe-img",3,"src"],[1,"d-flex","align-items-center","justify-content-center","bg-secondary","text-dark","detalhe-img",2,"height","200px","font-size","3rem"],[1,"atributo-item"],[1,"text-light"],[1,"mt-3"],[1,"fw-bold","text-light"],["class","descricao-text",4,"ngIf"],["class","fw-bold text-light mt-3",4,"ngIf"],["class","ataques-text",4,"ngIf"],[1,"descricao-text"],[1,"fw-bold","text-light","mt-3"],[1,"ataques-text"],[1,"alert","alert-warning","mt-4"]],template:function(i,r){i&1&&(a(0,"div",1)(1,"div",2)(2,"div",3),g(3,R,4,0,"div",4)(4,H,48,17,"div",5)(5,K,2,0,"div",6),n()(),a(6,"div",7)(7,"button",8),S("click",function(){return r.voltarBatalha()}),t(8," \u2B05\uFE0F "),n()()()),i&2&&(l(3),c("ngIf",r.loading),l(),c("ngIf",!r.loading&&r.jogador),l(),c("ngIf",!r.loading&&!r.jogador))},dependencies:[j,J,B,F],styles:[".jogador-detalhe-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.jogador-detalhe-container[_ngcontent-%COMP%]{width:100%;max-width:900px;margin:0 auto}.detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{height:220px;object-fit:cover;width:100%}.fallback-icone[_ngcontent-%COMP%]{font-size:3rem}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:.95rem}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:#f1f1f1;display:flex;align-items:center;gap:6px;flex-wrap:wrap}.info-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:8px 12px;font-size:.9rem;color:#f1f1f1}.atributo-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;white-space:nowrap;font-size:.9rem;background:#2a2a2a;border-radius:6px;padding:6px 10px}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#ccc}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.descricao-text[_ngcontent-%COMP%], .ataques-text[_ngcontent-%COMP%]{white-space:pre-line;background:#2a2a2a;border-radius:6px;padding:10px 12px;line-height:1.5;font-size:.95rem}.descricao-text[_ngcontent-%COMP%]{color:#f1f1f1}.ataques-text[_ngcontent-%COMP%]{color:#f8d775}.fab-stack[_ngcontent-%COMP%]{position:fixed;bottom:70px;right:20px;display:flex;flex-direction:column;gap:15px;z-index:1000}.fab[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;font-size:1.6rem;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 14px #0006;transition:transform .2s ease}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.08)}.fab-primary[_ngcontent-%COMP%]{background:#0d6efd;color:#fff}.fab-primary[_ngcontent-%COMP%]:hover{background:#0b5ed7}.fab-warning[_ngcontent-%COMP%]{background:#ffc107;color:#000}.fab-warning[_ngcontent-%COMP%]:hover{background:#e0a800}@media (min-width: 992px){.jogador-detalhe-container[_ngcontent-%COMP%]{padding:0 2rem}.detalhe-card[_ngcontent-%COMP%]{border-radius:16px}.fab-stack[_ngcontent-%COMP%]{right:calc(50% - 430px)}}"]})};export{q as JogadorDetalhesBatalha};
