import{c as q,f as V,i as N,r as j}from"./chunk-GFP7435U.js";import{b as L}from"./chunk-KJ5OHPYV.js";import{f as T,g as A,j as z,s as R}from"./chunk-WLM7QTUH.js";import{$b as u,Fb as h,Jb as g,Lb as m,Pa as w,Qa as o,Va as P,Xb as _,Yb as k,Zb as s,_b as v,a as y,ab as O,b as M,cc as I,d as f,dc as E,ec as F,fb as p,fc as D,gc as S,ia as x,ja as b,wb as d,xb as r,yb as l,zb as C}from"./chunk-QQSIVCMV.js";function B(i,e){i&1&&(r(0,"div",13),C(1,"div",14),r(2,"p",15),s(3,"Carregando cat\xE1logo..."),l()())}function W(i,e){i&1&&(r(0,"div",16),s(1," Nenhum item encontrado. "),l())}function U(i,e){if(i&1&&C(0,"img",33),i&2){let t=m().$implicit;d("alt",D(t.nome||"Item"))("src",t.imagem,w)}}function G(i,e){i&1&&(r(0,"span",34),s(1,"\u{1F4E6}"),l())}function H(i,e){if(i&1&&(r(0,"p",35),s(1),l()),i&2){let t=m().$implicit;o(),u("\u2728 ",t.efeito)}}function J(i,e){if(i&1&&(r(0,"p",36),s(1),l()),i&2){let t=m().$implicit;o(),u("\u26A0\uFE0F ",t.colateral)}}function K(i,e){if(i&1&&(r(0,"p",37),s(1),l()),i&2){let t=m().$implicit;o(),u("\u{1F4DD} ",t.descricao)}}function Q(i,e){if(i&1){let t=h();r(0,"div",23)(1,"div",24),g("click",function(){let n=x(t).$implicit,c=m(4);return b(c.abrirItem(n))}),r(2,"div",25)(3,"div",26),p(4,U,1,3,"img",27)(5,G,2,0,"span",28),l(),r(6,"div")(7,"h6",29),s(8),l(),r(9,"small"),s(10),l()()(),p(11,H,2,1,"p",30)(12,J,2,1,"p",31)(13,K,2,1,"p",32),l()()}if(i&2){let t=e.$implicit,a=m(4);o(4),d("ngIf",t.imagem&&t.imagem!=="-"),o(),d("ngIf",!t.imagem||t.imagem==="-"),o(3),v(t.nome||"Sem nome"),o(),k(S("raridade ",a.getRaridadeClass(t.raridade))),o(),u(" ",t.raridade||"Comum"," "),o(),d("ngIf",t.efeito),o(),d("ngIf",t.colateral),o(),d("ngIf",t.descricao)}}function X(i,e){if(i&1&&(r(0,"div",15)(1,"div",21),p(2,Q,14,10,"div",22),l()()),i&2){let t=m().$implicit;o(2),d("ngForOf",t.itens)}}function Y(i,e){if(i&1){let t=h();r(0,"div",18)(1,"button",19),g("click",function(){let n=x(t).$implicit,c=m(2);return b(c.toggleCategoria(n))}),r(2,"span"),s(3),l(),r(4,"span"),s(5),l()(),p(6,X,3,1,"div",20),l()}if(i&2){let t=e.$implicit,a=m(2);d("hidden",!a.pertenceAba(t.nome)),o(3),v(t.nome||"Outros"),o(2),v(t.expandido?"\u2212":"+"),o(),d("ngIf",t.expandido)}}function Z(i,e){if(i&1&&(r(0,"div"),p(1,Y,7,4,"div",17),l()),i&2){let t=m();o(),d("ngForOf",t.categoriasFiltradas)}}var $=class i{constructor(e){this.router=e}categorias=[];categoriasFiltradas=[];carregando=!0;filtro="";abaAtiva="recursos";repo=new L("Catalogo","Catalogo");mapaAbas={recursos:["Recursos bot\xE2nicos","Mineral","Componentes bestiais e animalescos","Tesouro","Moeda"],equipamentos:["Equipamento","Ferramentas","Utilit\xE1rio \u2013 Bombas, armadilhas, luz, som, g\xE1s, adesivos"],pocoes:["Po\xE7\xE3o de Cura \u2013 Regenera vida, cicatriza feridas","Po\xE7\xE3o Mental \u2013 Calmante, foco, mem\xF3ria, sono, esquecimento","Po\xE7\xE3o de Aprimoramento F\xEDsico \u2013 For\xE7a, resist\xEAncia, agilidade","Po\xE7\xE3o Sensorial \u2013 Vis\xE3o, audi\xE7\xE3o, percep\xE7\xE3o, voz, respira\xE7\xE3o","Po\xE7\xE3o de Furtividade \u2013 Camuflagem, passos suaves, sil\xEAncio","Po\xE7\xE3o de Energia \u2013 Percep\xE7\xE3o da energia fundamental","Veneno \u2013 Sonol\xEAncia, confus\xE3o ou morte"],outros:["Outros"]};ngOnInit(){return f(this,null,function*(){this.carregando=!0;try{yield this.loadLocalAndSync()}catch(e){console.error("[Catalogo] Erro ao carregar itens:",e)}finally{this.carregando=!1}})}loadLocalAndSync(){return f(this,null,function*(){let e=yield this.repo.getLocal();if(this.processarItens(e),this.repo.sync().then(t=>f(this,null,function*(){if(t){let a=yield this.repo.getLocal();this.processarItens(a)}})),e.length===0){let t=yield this.repo.forceFetch();this.processarItens(t)}})}processarItens(e){let t=new Map(this.categorias.map(n=>[n.nome,n.expandido])),a=new Map;e.forEach(n=>{let c=n.categoria||"Outros";a.has(c)||a.set(c,[]),a.get(c).push(n)}),this.categorias=Array.from(a.entries()).sort(([n],[c])=>n.localeCompare(c)).map(([n,c])=>({nome:n,itens:c,expandido:t.get(n)??!1})),this.categoriasFiltradas=[...this.categorias]}aplicarFiltro(){let e=this.normalizarTexto(this.filtro);if(!e){this.categoriasFiltradas=[...this.categorias];return}this.categoriasFiltradas=this.categorias.map(t=>{let a=t.itens.filter(n=>[n.nome,n.raridade,n.efeito,n.colateral,n.categoria].map(c=>this.normalizarTexto(String(c||""))).some(c=>c.includes(e)));return M(y({},t),{itens:a,expandido:a.length>0})}).filter(t=>t.itens.length>0)}normalizarTexto(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}selecionarAba(e){this.abaAtiva=e}pertenceAba(e){return this.mapaAbas[this.abaAtiva].includes(e)}toggleCategoria(e){e.expandido=!e.expandido}abrirItem(e){this.router.navigate(["/item-catalogo",e.id])}novoItem(){this.router.navigate(["/cadastro-item-catalogo"])}getRaridadeClass(e){return e?String(e).toLowerCase():"comum"}static \u0275fac=function(t){return new(t||i)(P(R))};static \u0275cmp=O({type:i,selectors:[["app-catalogo"]],decls:24,vars:12,consts:[[1,"catalogo-wrapper","d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"p-3","bg-black","border-bottom","position-sticky","top-0",2,"z-index","10"],["type","text","placeholder","\u{1F50D} Pesquisar no cat\xE1logo...",1,"form-control","search-bar","rounded-pill","px-3",3,"ngModelChange","input","ngModel"],["role","tablist",1,"nav","nav-tabs","bg-dark","px-3"],["role","presentation",1,"nav-item"],[1,"nav-link",3,"click"],[1,"flex-grow-1","p-3","d-flex","justify-content-center"],[1,"catalogo-container","w-100"],["class","text-center py-5",4,"ngIf"],["class","text-center text-muted py-5",4,"ngIf"],[4,"ngIf"],[1,"fab-stack"],[1,"fab","fab-primary",3,"click"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"text-center","text-muted","py-5"],["class","mb-3",3,"hidden",4,"ngFor","ngForOf"],[1,"mb-3",3,"hidden"],[1,"btn","btn-categoria","w-100","d-flex","justify-content-between","align-items-center",3,"click"],["class","mt-2",4,"ngIf"],[1,"row","row-cols-1","g-2"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[1,"card","catalogo-card","shadow-sm","h-100","p-3",2,"cursor","pointer",3,"click"],[1,"d-flex","align-items-center","mb-2"],[1,"item-thumb","me-3"],[3,"src","alt",4,"ngIf"],["class","text-muted fs-4",4,"ngIf"],[1,"fw-bold","text-white","mb-1"],["class","small mt-2 text-info",4,"ngIf"],["class","small text-danger",4,"ngIf"],["class","small descricao-text fst-italic",4,"ngIf"],[3,"src","alt"],[1,"text-muted","fs-4"],[1,"small","mt-2","text-info"],[1,"small","text-danger"],[1,"small","descricao-text","fst-italic"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"div",1)(2,"input",2),F("ngModelChange",function(c){return E(a.filtro,c)||(a.filtro=c),c}),g("input",function(){return a.aplicarFiltro()}),l()(),r(3,"ul",3)(4,"li",4)(5,"button",5),g("click",function(){return a.selecionarAba("recursos")}),s(6,"\u{1F33F} Recursos"),l()(),r(7,"li",4)(8,"button",5),g("click",function(){return a.selecionarAba("equipamentos")}),s(9,"\u2694\uFE0F Equipamentos"),l()(),r(10,"li",4)(11,"button",5),g("click",function(){return a.selecionarAba("pocoes")}),s(12,"\u{1F9EA} Po\xE7\xF5es"),l()(),r(13,"li",4)(14,"button",5),g("click",function(){return a.selecionarAba("outros")}),s(15,"\u{1F4E6} Outros"),l()()(),r(16,"div",6)(17,"div",7),p(18,B,4,0,"div",8)(19,W,2,0,"div",9)(20,Z,2,1,"div",10),l()(),r(21,"div",11)(22,"button",12),g("click",function(){return a.novoItem()}),s(23,"\uFF0B"),l()()()),t&2&&(o(2),I("ngModel",a.filtro),o(3),_("active",a.abaAtiva==="recursos"),o(3),_("active",a.abaAtiva==="equipamentos"),o(3),_("active",a.abaAtiva==="pocoes"),o(3),_("active",a.abaAtiva==="outros"),o(4),d("ngIf",a.carregando),o(),d("ngIf",!a.carregando&&a.categoriasFiltradas.length===0),o(),d("ngIf",!a.carregando))},dependencies:[z,T,A,j,q,V,N],styles:[".nav-tabs[_ngcontent-%COMP%]{border-bottom:1px solid #444}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#aaa;background:transparent;border:none;font-weight:600}.catalogo-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.catalogo-container[_ngcontent-%COMP%]{width:100%;max-width:900px}.search-bar[_ngcontent-%COMP%]{background:#1e1e1e;color:#fff;border:1px solid #444}.search-bar[_ngcontent-%COMP%]:focus{outline:none;border-color:#0d6efd;box-shadow:0 0 0 .2rem #0d6efd40}.btn-categoria[_ngcontent-%COMP%]{background:#2a2a2a;color:#f8f9fa;font-weight:600;border-radius:8px;padding:.6rem 1rem;text-align:left}.btn-categoria[_ngcontent-%COMP%]:hover{background:#343a40;color:#fff}.catalogo-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:10px;transition:transform .15s ease;color:#f1f1f1}.catalogo-card[_ngcontent-%COMP%]:hover{transform:scale(1.02);background:#252525}.item-thumb[_ngcontent-%COMP%]{width:55px;height:55px;border-radius:8px;background:#2a2a2a;display:flex;align-items:center;justify-content:center;overflow:hidden}.item-thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.item-thumb[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#bbb}.catalogo-card[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#fff}.catalogo-card[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#ddd}.catalogo-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#e0e0e0;white-space:pre-line}.fab-stack[_ngcontent-%COMP%]{position:fixed;bottom:70px;right:20px;display:flex;flex-direction:column;gap:15px;z-index:1000}.fab[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;font-size:1.6rem;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 14px #0006;border:none;cursor:pointer;transition:transform .2s ease}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.08)}.fab-primary[_ngcontent-%COMP%]{background:#0d6efd;color:#fff}.fab-primary[_ngcontent-%COMP%]:hover{background:#0b5ed7}@media (min-width: 992px){.catalogo-container[_ngcontent-%COMP%]{padding:0 2rem}.fab-stack[_ngcontent-%COMP%]{right:50%;transform:translate(450px)}}.nav-tabs[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch;border-bottom:1px solid #444;scrollbar-width:none}.nav-tabs[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.nav-tabs[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{flex:1 0 auto;text-align:center}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#aaa;background:transparent;border:none;font-weight:600;padding:.5rem .8rem;display:flex;align-items:center;gap:6px;white-space:nowrap}.nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#fff;background:#2a2a2a;border-radius:8px 8px 0 0}"]})};export{$ as Catalogo};
