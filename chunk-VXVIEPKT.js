import{a as Q,b as Y,c as Z,d as $,e as ee,f as te,g as ie,h as oe,i as ne}from"./chunk-EHPGXDFJ.js";import{A as N,N as W}from"./chunk-TRWM2F5J.js";import{a as K}from"./chunk-FJZA3HMC.js";import{b as R,e as L,f as j,g as B,h as P,i as U,j as q,o as z,p as G,q as X}from"./chunk-6EPUS52O.js";import"./chunk-W7DVKRY2.js";import{a as H}from"./chunk-HS244SCX.js";import{Ga as m,Ha as n,Ia as r,Ib as T,Ja as S,Jb as J,Mb as A,Na as V,Oa as x,Pa as O,Ra as g,S as c,T as f,Ta as C,Tb as D,Vb as k,bb as _,d as w,fb as s,gb as E,ha as y,hb as F,ia as l,kb as h,lb as b,ma as M,mb as v,qa as I,ua as u}from"./chunk-ILJPX4RU.js";function re(a,i){if(a&1&&S(0,"img",24),a&2){let t=C().$implicit;m("src",t.imagem,y)}}function le(a,i){if(a&1&&(n(0,"mat-option",21)(1,"div",22),u(2,re,1,1,"img",23),n(3,"span"),s(4),r()()()),a&2){let t=i.$implicit;m("value",t),l(2),m("ngIf",t.imagem),l(2),E(t.personagem)}}function me(a,i){if(a&1&&S(0,"img",24),a&2){let t=C().$implicit;m("src",t.imagem,y)}}function se(a,i){if(a&1&&(n(0,"mat-option",21)(1,"div",22),u(2,me,1,1,"img",23),n(3,"span"),s(4),r()()()),a&2){let t=i.$implicit;m("value",t),l(2),m("ngIf",t.imagem),l(2),E(t.personagem)}}function de(a,i){if(a&1&&(n(0,"div",25),s(1),n(2,"span",26),s(3,"X"),r(),s(4),r()),a&2){let t=C();l(),F(" \u2694\uFE0F ",t.ofensorSelecionado.personagem," "),l(3),F(" ",t.vitimaSelecionada.personagem," ")}}function pe(a,i){a&1&&(V(0),s(1,"Registrar"),x())}function ce(a,i){a&1&&(V(0),S(1,"span",27),s(2," Registrando... "),x())}var ae=class a{constructor(i,t){this.router=i;this.route=t}todosJogadores=[];ofensorSelecionado=null;vitimaSelecionada=null;filtroOfensor="";filtroVitima="";ofensoresFiltrados=[];vitimasFiltradas=[];dano=0;efeitos="";salvando=!1;ngOnInit(){return w(this,null,function*(){this.todosJogadores=yield K.getLocalJogadores();let i=H.getUser();this.ofensorSelecionado=this.todosJogadores.find(e=>e.email===i?.email)||null,this.filtroOfensor=this.ofensorSelecionado?.personagem||"",this.ofensoresFiltrados=[...this.todosJogadores];let t=this.route.snapshot.paramMap.get("id");t&&(this.vitimaSelecionada=this.todosJogadores.find(e=>String(e.id)===t)||null,this.filtroVitima=this.vitimaSelecionada?.personagem||""),this.vitimasFiltradas=[...this.todosJogadores]})}filtrarOfensores(){let i=this.filtroOfensor.toLowerCase().trim();this.ofensoresFiltrados=i?this.todosJogadores.filter(t=>t.personagem.toLowerCase().includes(i)):[...this.todosJogadores]}filtrarVitimas(){let i=this.filtroVitima.toLowerCase().trim();this.vitimasFiltradas=i?this.todosJogadores.filter(t=>t.personagem.toLowerCase().includes(i)):[...this.todosJogadores]}selecionarOfensor(i){this.ofensorSelecionado=i,this.filtroOfensor=i.personagem}selecionarVitima(i){this.vitimaSelecionada=i,this.filtroVitima=i.personagem}incrementar(){this.dano++}decrementar(){this.dano=Math.max(0,this.dano-1)}cancelar(){this.router.navigate(["/batalha"])}registrarCombate(i){return w(this,null,function*(){if(!(i.invalid||!this.ofensorSelecionado||!this.vitimaSelecionada)){this.salvando=!0;try{console.log("\u2694\uFE0F Combate registrado:",{ofensor:this.ofensorSelecionado,vitima:this.vitimaSelecionada,dano:this.dano,efeitos:this.efeitos}),alert(`\u2705 ${this.ofensorSelecionado.personagem} causou ${this.dano} de dano em ${this.vitimaSelecionada.personagem}!`),this.router.navigate(["/batalha"])}catch(t){console.error("[Combate] Erro ao registrar:",t),alert("\u274C Erro ao registrar combate.")}finally{this.salvando=!1}}})}static \u0275fac=function(t){return new(t||a)(M(k),M(D))};static \u0275cmp=I({type:a,selectors:[["app-combate"]],decls:39,vars:12,consts:[["form","ngForm"],["autoOfensor","matAutocomplete"],["autoVitima","matAutocomplete"],[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light","p-3"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label","text-light"],["appearance","outline",1,"w-100"],["type","text","matInput","","placeholder","Selecione o ofensor...","name","filtroOfensor",1,"text-light",3,"ngModelChange","input","ngModel","matAutocomplete"],[3,"optionSelected"],["class","bg-dark text-light",3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","placeholder","Selecione a v\xEDtima...","name","filtroVitima",1,"text-light",3,"ngModelChange","input","ngModel","matAutocomplete"],["class","card bg-secondary text-light shadow-sm mb-3 p-3 text-center fw-bold",4,"ngIf"],[1,"input-group"],["type","button",1,"btn","btn-outline-light",3,"click"],["type","number","name","dano","min","0","required","",1,"form-control","bg-dark","text-light","border-light","text-center","fw-bold",3,"ngModelChange","ngModel"],["rows","2","name","efeitos","placeholder","Ex: sangramento, atordoamento...",1,"form-control","bg-dark","text-light","border-light",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between","mt-4"],["type","button",1,"btn","btn-secondary","px-4",3,"click"],["type","submit",1,"btn","btn-success","px-4",3,"disabled"],[4,"ngIf"],[1,"bg-dark","text-light",3,"value"],[1,"d-flex","align-items-center"],["class","me-2 rounded","style","width: 28px; height: 28px; object-fit: cover;",3,"src",4,"ngIf"],[1,"me-2","rounded",2,"width","28px","height","28px","object-fit","cover",3,"src"],[1,"card","bg-secondary","text-light","shadow-sm","mb-3","p-3","text-center","fw-bold"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(t,e){if(t&1){let d=O();n(0,"div",3)(1,"form",4,0),g("ngSubmit",function(){c(d);let o=_(2);return f(e.registrarCombate(o))}),n(3,"div",5)(4,"label",6),s(5,"Ofensor *"),r(),n(6,"mat-form-field",7)(7,"input",8),v("ngModelChange",function(o){return c(d),b(e.filtroOfensor,o)||(e.filtroOfensor=o),f(o)}),g("input",function(){return c(d),f(e.filtrarOfensores())}),r(),n(8,"mat-autocomplete",9,1),g("optionSelected",function(o){return c(d),f(e.selecionarOfensor(o.option.value))}),u(10,le,5,3,"mat-option",10),r()()(),n(11,"div",5)(12,"label",6),s(13,"V\xEDtima *"),r(),n(14,"mat-form-field",7)(15,"input",11),v("ngModelChange",function(o){return c(d),b(e.filtroVitima,o)||(e.filtroVitima=o),f(o)}),g("input",function(){return c(d),f(e.filtrarVitimas())}),r(),n(16,"mat-autocomplete",9,2),g("optionSelected",function(o){return c(d),f(e.selecionarVitima(o.option.value))}),u(18,se,5,3,"mat-option",10),r()()(),u(19,de,5,2,"div",12),n(20,"div",5)(21,"label",6),s(22,"Dano *"),r(),n(23,"div",13)(24,"button",14),g("click",function(){return c(d),f(e.decrementar())}),s(25,"\u2212"),r(),n(26,"input",15),v("ngModelChange",function(o){return c(d),b(e.dano,o)||(e.dano=o),f(o)}),r(),n(27,"button",14),g("click",function(){return c(d),f(e.incrementar())}),s(28,"+"),r()()(),n(29,"div",5)(30,"label",6),s(31,"Efeitos adicionais"),r(),n(32,"textarea",16),v("ngModelChange",function(o){return c(d),b(e.efeitos,o)||(e.efeitos=o),f(o)}),r()(),n(33,"div",17)(34,"button",18),g("click",function(){return c(d),f(e.cancelar())}),s(35,"Cancelar"),r(),n(36,"button",19),u(37,pe,2,0,"ng-container",20)(38,ce,3,0,"ng-container",20),r()()()()}if(t&2){let d=_(2),p=_(9),o=_(17);l(7),h("ngModel",e.filtroOfensor),m("matAutocomplete",p),l(3),m("ngForOf",e.ofensoresFiltrados),l(5),h("ngModel",e.filtroVitima),m("matAutocomplete",o),l(3),m("ngForOf",e.vitimasFiltradas),l(),m("ngIf",e.ofensorSelecionado&&e.vitimaSelecionada),l(7),h("ngModel",e.dano),l(6),h("ngModel",e.efeitos),l(4),m("disabled",d.invalid||e.salvando),l(),m("ngIf",!e.salvando),l(),m("ngIf",e.salvando)}},dependencies:[A,T,J,X,U,R,q,L,j,G,z,P,B,Y,Q,ie,ee,Z,te,ne,oe,$,N,W],encapsulation:2})};export{ae as Combate};
