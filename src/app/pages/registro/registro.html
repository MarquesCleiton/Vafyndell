<div class="registro-wrapper d-flex flex-column min-vh-100 bg-dark text-light">
  <!-- 🔍 Barra de pesquisa -->
  <div class="p-3 bg-black border-bottom position-sticky top-0" style="z-index: 10;">
    <input
      type="text"
      class="form-control search-bar rounded-pill px-3 mb-2"
      placeholder="🔍 Pesquisar registros..."
      [(ngModel)]="filtro"
      (input)="aplicarFiltro()"
    />

    <!-- 🎭 Filtros -->
    <div class="d-flex flex-column gap-2">
      <select
        class="form-select filtro-visao"
        [(ngModel)]="filtroVisao"
        (change)="aplicarFiltro()"
      >
        <option value="todos">Todos</option>
        <option
          *ngFor="let j of outrosJogadores"
          [value]="j.email"
        >
          {{ getEmoji(j) }} {{ j.personagem }}
        </option>
      </select>
    </div>
  </div>

  <!-- 📜 Conteúdo -->
  <div class="flex-grow-1 p-3 d-flex justify-content-center">
    <div class="registro-container w-100">
      <h4 class="fw-bold mb-3">📜 Registro de Jogo</h4>

      <!-- Loading -->
      <div *ngIf="carregando" class="text-center py-5">
        <div class="spinner-border text-light" role="status"></div>
        <p class="mt-2">Carregando registros...</p>
      </div>

      <!-- Vazio -->
      <div *ngIf="!carregando && secoesFiltradas.length === 0" class="text-center text-muted py-5">
        Nenhum registro encontrado.
      </div>

      <!-- Seções -->
      <div *ngIf="!carregando">
        <div *ngFor="let secao of secoesFiltradas" class="mb-3">
          <button class="btn-categoria w-100 text-start d-flex justify-content-between align-items-center" (click)="toggleSecao(secao)">
            <span class="fw-bold " >📅 {{ formatarData(secao.data) }}</span>
            <span>{{ secao.expandido ? '−' : '+' }}</span>
          </button>

          <div *ngIf="secao.expandido" class="mt-2">
            <div class="row row-cols-1 g-2">
              <div class="col " *ngFor="let registro of secao.itens">
                <div
                  class="text-light registro-card card shadow-sm p-3"
                  [style.border-left]="'6px solid ' + (registro.cor || '#666')"
                >
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <h6 class="fw-bold mb-0">{{ registro.icone }} {{ registro.tipo | titlecase }}</h6>
                    <small class="registro-hora">{{ registro.data | date:'HH:mm' }}</small>
                  </div>
                  <p class="small descricao-text fst-italic mb-0" style="white-space: pre-line;">
                    {{ registro.detalhes }}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
