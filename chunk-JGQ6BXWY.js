import{a as x}from"./chunk-2YMM3WEV.js";import{a as L,b as A,c as B,d as O,e as q,f as j,g as z,h as U,i as H,j as G,k as J,l as K,m as Q}from"./chunk-S3AV3E44.js";import"./chunk-DUOZFNR4.js";import{a as X}from"./chunk-OZ52KALQ.js";import{$ as D,Ba as w,Ca as b,Da as y,Fa as M,Ha as E,M as g,N as c,Oa as S,Sa as d,Ta as h,V as F,Wa as u,Xa as f,Ya as C,aa as l,ab as T,d as V,da as v,fa as W,ja as _,lb as P,mb as N,nb as k,ua as p,va as i,wa as n,wb as R,xa as I}from"./chunk-DR7ZYR7E.js";function Z(r,m){if(r&1){let a=y();w(0),I(1,"img",26),i(2,"button",27),M("click",function(){g(a);let o=E();return c(o.removerImagem())}),d(3,"\u2716"),n(),b()}if(r&2){let a=E();l(),p("src",a.item.imagem,D)}}function $(r,m){if(r&1){let a=y();i(0,"label",28)(1,"span",29),d(2,"\u{1F4F7}"),n(),i(3,"input",30),M("change",function(o){g(a);let s=E();return c(s.onFileChange(o))}),n()()}}function ee(r,m){if(r&1&&(i(0,"option"),d(1),n()),r&2){let a=m.$implicit;l(),h(a)}}function te(r,m){if(r&1&&(i(0,"option"),d(1),n()),r&2){let a=m.$implicit;l(),h(a)}}function ie(r,m){if(r&1&&(i(0,"option"),d(1),n()),r&2){let a=m.$implicit;l(),h(a)}}function ae(r,m){if(r&1&&(i(0,"option"),d(1),n()),r&2){let a=m.$implicit;l(),h(a)}}function ne(r,m){r&1&&(w(0),d(1,"\u{1F4BE} Salvar"),b())}function oe(r,m){r&1&&(w(0),I(1,"span",31),d(2," Salvando... "),b())}var Y=class r{constructor(m,a){this.router=m;this.el=a}item={index:0,id:0,nome:"",unidade_medida:"",peso:0,categoria:"",origem:"",raridade:"",efeito:"",colateral:"",descricao:"",imagem:"",email:""};salvando=!1;unidadesMedida=["g","kg","ml","l","cm","m","unidade"];origens=["Fabric\xE1vel","Natural"];raridades=["Comum","Incomum","Raro","\xC9pico","Lend\xE1rio"];categorias=["Recursos bot\xE2nicos","Mineral","Equipamento","Moeda","Tesouro","Componentes bestiais e animalescos","Po\xE7\xE3o de Cura \u2013 Regenera vida, cicatriza feridas","Po\xE7\xE3o Mental \u2013 Calmante, foco, mem\xF3ria, sono, esquecimento","Po\xE7\xE3o de Aprimoramento F\xEDsico \u2013 For\xE7a, resist\xEAncia, agilidade","Po\xE7\xE3o Sensorial \u2013 Vis\xE3o, audi\xE7\xE3o, percep\xE7\xE3o, voz, respira\xE7\xE3o","Po\xE7\xE3o de Furtividade \u2013 Camuflagem, passos suaves, sil\xEAncio","Po\xE7\xE3o de Energia \u2013 Percep\xE7\xE3o da energia fundamental","Veneno \u2013 Sonol\xEAncia, confus\xE3o ou morte","Utilit\xE1rio \u2013 Bombas, armadilhas, luz, som, g\xE1s, adesivos","Ferramentas","Outros"];ngAfterViewInit(){this.el.nativeElement.querySelectorAll("textarea.auto-expand").forEach(a=>{let e=()=>{a.style.height="auto",a.style.height=Math.min(a.scrollHeight,200)+"px"};a.addEventListener("input",e),e()})}onFileChange(m){let a=m.target;if(a.files&&a.files.length>0){let e=a.files[0],o=new FileReader;o.onload=()=>{this.item.imagem=o.result},o.readAsDataURL(e)}}removerImagem(){this.item.imagem=""}salvar(m){return V(this,null,function*(){if(!m.invalid)try{this.salvando=!0;let a=X.getUser();if(!a?.email)throw new Error("Usu\xE1rio n\xE3o autenticado");this.item.email=a.email,yield x.syncItens();let e=yield x.getAllItens(),o=0;e.length>0&&(o=Math.max(...e.map(s=>s.index||0))),this.item.index=o+1,this.item.id=o+1,yield x.createItem(this.item),window.alert("\u2705 Item salvo com sucesso!"),this.router.navigate(["/catalogo"])}catch(a){console.error("[CadastroItemCatalogo] Erro ao salvar:",a),window.alert("\u274C Erro ao salvar item. Veja o console.")}finally{this.salvando=!1}})}static \u0275fac=function(a){return new(a||r)(v(R),v(F))};static \u0275cmp=W({type:r,selectors:[["app-cadastro-item-catalogo"]],decls:64,vars:18,consts:[["form","ngForm"],["uploadBox",""],[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light","mb-5"],[1,"flex-grow-1"],[3,"ngSubmit"],[1,"position-relative","text-center","mb-3"],[4,"ngIf","ngIfElse"],[1,"card","bg-dark","border-0","shadow-sm"],[1,"card-body"],[1,"fw-bold","mb-3","text-white"],[1,"mb-3"],[1,"form-label","text-white"],["type","text","name","nome","required","",1,"form-control","bg-dark","text-light","border-light",3,"ngModelChange","ngModel"],["name","unidadeMedida","required","",1,"form-select","bg-dark","text-light","border-light",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],[4,"ngFor","ngForOf"],["type","number","name","peso","min","0",1,"form-control","bg-dark","text-light","border-light",3,"ngModelChange","ngModel"],["name","categoria","required","",1,"form-select","bg-dark","text-light","border-light",3,"ngModelChange","ngModel"],["name","origem","required","",1,"form-select","bg-dark","text-light","border-light",3,"ngModelChange","ngModel"],["name","raridade","required","",1,"form-select","bg-dark","text-light","border-light",3,"ngModelChange","ngModel"],["name","descricao",1,"form-control","bg-dark","text-light","border-light","auto-expand",3,"ngModelChange","ngModel"],["name","efeito",1,"form-control","bg-dark","text-light","border-light","auto-expand",3,"ngModelChange","ngModel"],["name","colateral",1,"form-control","bg-dark","text-light","border-light","auto-expand",3,"ngModelChange","ngModel"],[1,"text-end","mt-4"],["type","submit",1,"btn","btn-success","px-4",3,"disabled"],[4,"ngIf"],["alt","Preview",1,"w-100","rounded","shadow-sm",2,"height","250px","object-fit","cover",3,"src"],["type","button",1,"btn","btn-danger","rounded-circle","position-absolute","d-flex","align-items-center","justify-content-center",2,"top","10px","right","10px","width","40px","height","40px",3,"click"],[1,"d-flex","align-items-center","justify-content-center","border","rounded","w-100",2,"height","150px","background","#1e1e1e","cursor","pointer"],[1,"text-success","fs-1"],["type","file","accept","image/*",1,"d-none",3,"change"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(a,e){if(a&1){let o=y();i(0,"div",2)(1,"div",3)(2,"form",4,0),M("ngSubmit",function(){g(o);let t=S(3);return c(e.salvar(t))}),i(4,"div",5),_(5,Z,4,1,"ng-container",6)(6,$,4,0,"ng-template",null,1,T),n(),i(8,"div",7)(9,"div",8)(10,"h4",9),d(11,"\u{1F4E6} Cadastro de Item do Cat\xE1logo"),n(),i(12,"div",10)(13,"label",11),d(14,"\u{1F3F7}\uFE0F Nome *"),n(),i(15,"input",12),C("ngModelChange",function(t){return g(o),f(e.item.nome,t)||(e.item.nome=t),c(t)}),n()(),i(16,"div",10)(17,"label",11),d(18,"\u2696\uFE0F Unidade de Medida *"),n(),i(19,"select",13),C("ngModelChange",function(t){return g(o),f(e.item.unidade_medida,t)||(e.item.unidade_medida=t),c(t)}),i(20,"option",14),d(21,"Selecione..."),n(),_(22,ee,2,1,"option",15),n()(),i(23,"div",10)(24,"label",11),d(25,"\u2696\uFE0F Peso"),n(),i(26,"input",16),C("ngModelChange",function(t){return g(o),f(e.item.peso,t)||(e.item.peso=t),c(t)}),n()(),i(27,"div",10)(28,"label",11),d(29,"\u{1F4C2} Categoria *"),n(),i(30,"select",17),C("ngModelChange",function(t){return g(o),f(e.item.categoria,t)||(e.item.categoria=t),c(t)}),i(31,"option",14),d(32,"Selecione..."),n(),_(33,te,2,1,"option",15),n()(),i(34,"div",10)(35,"label",11),d(36,"\u{1F331} Origem *"),n(),i(37,"select",18),C("ngModelChange",function(t){return g(o),f(e.item.origem,t)||(e.item.origem=t),c(t)}),i(38,"option",14),d(39,"Selecione..."),n(),_(40,ie,2,1,"option",15),n()(),i(41,"div",10)(42,"label",11),d(43,"\u{1F48E} Raridade *"),n(),i(44,"select",19),C("ngModelChange",function(t){return g(o),f(e.item.raridade,t)||(e.item.raridade=t),c(t)}),i(45,"option",14),d(46,"Selecione..."),n(),_(47,ae,2,1,"option",15),n()(),i(48,"div",10)(49,"label",11),d(50,"\u{1F4DD} Descri\xE7\xE3o"),n(),i(51,"textarea",20),C("ngModelChange",function(t){return g(o),f(e.item.descricao,t)||(e.item.descricao=t),c(t)}),n()(),i(52,"div",10)(53,"label",11),d(54,"\u2728 Efeito"),n(),i(55,"textarea",21),C("ngModelChange",function(t){return g(o),f(e.item.efeito,t)||(e.item.efeito=t),c(t)}),n()(),i(56,"div",10)(57,"label",11),d(58,"\u26A0\uFE0F Colateral"),n(),i(59,"textarea",22),C("ngModelChange",function(t){return g(o),f(e.item.colateral,t)||(e.item.colateral=t),c(t)}),n()()()(),i(60,"div",23)(61,"button",24),_(62,ne,2,0,"ng-container",25)(63,oe,3,0,"ng-container",25),n()()()()()}if(a&2){let o=S(3),s=S(7);l(5),p("ngIf",e.item.imagem)("ngIfElse",s),l(10),u("ngModel",e.item.nome),l(4),u("ngModel",e.item.unidade_medida),l(3),p("ngForOf",e.unidadesMedida),l(4),u("ngModel",e.item.peso),l(4),u("ngModel",e.item.categoria),l(3),p("ngForOf",e.categorias),l(4),u("ngModel",e.item.origem),l(3),p("ngForOf",e.origens),l(4),u("ngModel",e.item.raridade),l(3),p("ngForOf",e.raridades),l(4),u("ngModel",e.item.descricao),l(4),u("ngModel",e.item.efeito),l(4),u("ngModel",e.item.colateral),l(2),p("disabled",o.invalid||e.salvando),l(),p("ngIf",!e.salvando),l(),p("ngIf",e.salvando)}},dependencies:[k,P,N,Q,j,H,G,L,z,U,A,B,K,J,q,O],styles:["textarea.auto-expand[_ngcontent-%COMP%]{min-height:60px;max-height:200px;overflow-y:auto;resize:none}"]})};export{Y as CadastroItemCatalogo};
