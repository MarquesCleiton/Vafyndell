import{a as $}from"./chunk-GCWHHWHJ.js";import{c as z,f as L,g as B,h as W,i as R,j as U,k as q,m as G,n as H,o as X,q as Y,r as K,s as Q}from"./chunk-NOURQFKT.js";import{a as Z}from"./chunk-W2L5F7JW.js";import{h as T}from"./chunk-P5XSKUQX.js";import{e as J,h as N,i as A,q as I,x as j}from"./chunk-UNL43WIN.js";import{Ab as u,Bb as e,Cb as t,Db as M,Hb as h,Ib as C,Jb as _,Nb as p,Pb as s,Sa as P,Ua as c,Za as w,Zb as S,a as k,bc as i,cc as x,eb as O,ec as V,g as f,gc as v,hc as E,ic as y,jb as b,jc as D,la as m,ma as g,sc as F}from"./chunk-XPYPFFIJ.js";function oe(d,r){if(d&1){let o=_();h(0),M(1,"img",27),e(2,"button",28),p("click",function(){m(o);let a=s(2);return g(a.removerImagem())}),i(3,"\u2716"),t(),C()}if(d&2){let o=s(2);c(),u("src",o.jogador.imagem,P)}}function ie(d,r){if(d&1){let o=_();e(0,"label",29)(1,"span",30),i(2,"\u{1F4F7}"),t(),e(3,"input",31),p("change",function(a){m(o);let l=s(2);return g(l.onFileChange(a))}),t()()}}function ne(d,r){if(d&1){let o=_();e(0,"div",32)(1,"div",33),i(2),t(),e(3,"div",34)(4,"button",35),p("click",function(){let a=m(o).$implicit,l=s(2);return g(l.ajustarValor(a.key,-1))}),i(5,"\u2212"),t(),e(6,"input",36),p("ngModelChange",function(a){let l=m(o).$implicit,te=s(2);return g(te.setValor(l.key,a))}),t(),e(7,"button",35),p("click",function(){let a=m(o).$implicit,l=s(2);return g(l.ajustarValor(a.key,1))}),i(8,"+"),t()()()}if(d&2){let o=r.$implicit,n=s(2);c(2),V(" ",o.icon," ",o.label," "),c(4),u("name",D(o.key))("ngModel",n.getValor(o.key))}}function ae(d,r){if(d&1){let o=_();e(0,"form",10,0),p("ngSubmit",function(){m(o);let a=S(1),l=s();return g(l.salvar(a))}),e(2,"div",11),b(3,oe,4,1,"ng-container",12)(4,ie,4,0,"ng-template",null,1,F),t(),e(6,"div",13)(7,"div",14)(8,"h4",15),i(9,"\u270F\uFE0F Edi\xE7\xE3o de Personagem"),t(),e(10,"div",16)(11,"label",17),i(12,"\u{1F9D9} Nome do Personagem *"),t(),e(13,"input",18),y("ngModelChange",function(a){m(o);let l=s();return E(l.jogador.personagem,a)||(l.jogador.personagem=a),g(a)}),t()(),e(14,"div",16)(15,"label",17),i(16,"\u2696\uFE0F Alinhamento *"),t(),e(17,"select",19),y("ngModelChange",function(a){m(o);let l=s();return E(l.jogador.alinhamento,a)||(l.jogador.alinhamento=a),g(a)}),e(18,"option",20),i(19,"Selecione..."),t(),e(20,"option"),i(21,"Leal e Bom (Lawful Good)"),t(),e(22,"option"),i(23,"Neutro e Bom (Neutral Good)"),t(),e(24,"option"),i(25,"Ca\xF3tico e Bom (Chaotic Good)"),t(),e(26,"option"),i(27,"Leal e Neutro (Lawful Neutral)"),t(),e(28,"option"),i(29,"Neutro (True Neutral)"),t(),e(30,"option"),i(31,"Ca\xF3tico e Neutro (Chaotic Neutral)"),t(),e(32,"option"),i(33,"Leal e Mau (Lawful Evil)"),t(),e(34,"option"),i(35,"Neutro e Mau (Neutral Evil)"),t(),e(36,"option"),i(37,"Ca\xF3tico e Mau (Chaotic Evil)"),t()()(),e(38,"div",16)(39,"label",17),i(40,"\u{1F3AD} Tipo de Jogador *"),t(),e(41,"select",21),y("ngModelChange",function(a){m(o);let l=s();return E(l.jogador.tipo_jogador,a)||(l.jogador.tipo_jogador=a),g(a)}),e(42,"option",20),i(43,"Selecione..."),t(),e(44,"option"),i(45,"Aventureiro"),t(),e(46,"option"),i(47,"Mestre"),t()()(),e(48,"h6",22),i(49,"\u{1F4CA} Atributos Num\xE9ricos"),t(),e(50,"div",23),b(51,ne,9,5,"div",24),t(),e(52,"h6",22),i(53,"\u2694\uFE0F Atributos Calculados"),t(),e(54,"div",25)(55,"div",26)(56,"span"),i(57,"\u2764\uFE0F Vida"),t(),e(58,"b"),i(59),t(),e(60,"small"),i(61,"(Energia + Constitui\xE7\xE3o)"),t()(),e(62,"div",26)(63,"span"),i(64,"\u{1F496} Vida Total"),t(),e(65,"b"),i(66),t(),e(67,"small"),i(68,"(Vida + Armadura)"),t()(),e(69,"div",26)(70,"span"),i(71,"\u2728 Fator de Cura"),t(),e(72,"b"),i(73),t(),e(74,"small"),i(75,"(Energia / 3)"),t()(),e(76,"div",26)(77,"span"),i(78,"\u{1F3C3} Deslocamento"),t(),e(79,"b"),i(80),t(),e(81,"small"),i(82,"(Destreza / 3)"),t()()()()()()}if(d&2){let o=S(5),n=s();c(3),u("ngIf",n.jogador.imagem)("ngIfElse",o),c(10),v("ngModel",n.jogador.personagem),c(4),v("ngModel",n.jogador.alinhamento),c(24),v("ngModel",n.jogador.tipo_jogador),c(10),u("ngForOf",n.atributosNumericos),c(8),x(n.vida),c(7),x(n.vidaTotal),c(7),x(n.fatorCura),c(7),x(n.deslocamento)}}function re(d,r){d&1&&(h(0),i(1,"\u{1F4BE}"),C())}function le(d,r){d&1&&(h(0),M(1,"span",37),C())}var ee=class d{constructor(r,o){this.router=r;this.location=o}jogador=null;salvando=!1;repo=new Z("Personagem");atributosNumericos=[{key:"nivel",label:"N\xEDvel",icon:"\u{1F3C5}"},{key:"xp",label:"XP",icon:"\u2B50"},{key:"forca",label:"For\xE7a",icon:"\u{1F4AA}"},{key:"destreza",label:"Destreza",icon:"\u{1F3C3}"},{key:"constituicao",label:"Constitui\xE7\xE3o",icon:"\u{1FAA8}"},{key:"inteligencia",label:"Intelig\xEAncia",icon:"\u{1F9E0}"},{key:"sabedoria",label:"Sabedoria",icon:"\u{1F4D6}"},{key:"carisma",label:"Carisma",icon:"\u{1F60E}"},{key:"energia",label:"Energia",icon:"\u26A1"},{key:"classe_de_armadura",label:"Armadura",icon:"\u{1F6E1}\uFE0F"},{key:"escudo",label:"Escudo",icon:"\u{1F530}"},{key:"pontos_de_sorte",label:"Sorte",icon:"\u{1F340}"}];get vida(){return this.jogador?(this.jogador.energia||0)+(this.jogador.constituicao||0):0}get vidaTotal(){return this.jogador?this.vida+(this.jogador.classe_de_armadura||0):0}get fatorCura(){return this.jogador?Math.floor((this.jogador.energia||0)/3):0}get deslocamento(){return this.jogador?Math.floor((this.jogador.destreza||0)/3):0}getValor(r){return this.jogador&&this.jogador[r]||0}setValor(r,o){this.jogador&&(this.jogador[r]=Math.max(0,o))}ajustarValor(r,o){this.setValor(r,this.getValor(r)+o)}onFileChange(r){return f(this,null,function*(){let o=r.target;if(o.files?.length&&this.jogador)try{let n=o.files[0];this.jogador.imagem=yield $.toOptimizedBase64(n,.72,1024)}catch(n){console.error("[EdicaoJogador] Erro ao otimizar imagem:",n)}})}removerImagem(){this.jogador&&(this.jogador.imagem="")}salvar(r){return f(this,null,function*(){if(!(r.invalid||!this.jogador))try{this.salvando=!0;let o=j.getUser();if(!o?.email)throw new Error("Usu\xE1rio n\xE3o autenticado");this.jogador.email=o.email;let n=yield this.repo.update(this.jogador);this.jogador=k({},n),alert("\u2705 Jogador atualizado com sucesso!"),this.router.navigate(["/jogador"])}catch(o){console.error("[EdicaoJogador] Erro ao salvar:",o),alert("\u274C Erro ao salvar jogador. Veja o console.")}finally{this.salvando=!1}})}ngOnInit(){return f(this,null,function*(){try{let r=j.getUser();if(!r?.email)throw new Error("Usu\xE1rio n\xE3o autenticado");let o=(yield this.repo.getLocal()).find(n=>n.email===r.email);if(o&&(this.jogador=o),this.repo.sync().then(n=>f(this,null,function*(){if(n){let a=(yield this.repo.getLocal()).find(l=>l.email===r.email);a&&(this.jogador=a)}})),!o){let a=(yield this.repo.forceFetch()).find(l=>l.email===r.email);a?this.jogador=a:(alert("Nenhum jogador encontrado. V\xE1 para o cadastro primeiro."),this.router.navigate(["/cadastro-jogador"]))}}catch(r){console.error("[EdicaoJogador] Erro ao carregar jogador:",r),this.router.navigate(["/login"])}})}cancelar(){this.location.back()}static \u0275fac=function(o){return new(o||d)(w(T),w(J))};static \u0275cmp=O({type:d,selectors:[["app-edicao-jogador"]],decls:10,vars:4,consts:[["form","ngForm"],["uploadBox",""],[1,"jogador-edit-wrapper","d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","p-3","d-flex","justify-content-center"],[1,"jogador-edit-container","w-100"],["id","formJogador",3,"ngSubmit",4,"ngIf"],[1,"fab-stack"],[1,"fab","fab-primary",3,"click"],["type","submit","form","formJogador",1,"fab","fab-warning",3,"disabled"],[4,"ngIf"],["id","formJogador",3,"ngSubmit"],[1,"position-relative","text-center","mb-3"],[4,"ngIf","ngIfElse"],[1,"card","detalhe-card","shadow-lg","border-0"],[1,"card-body"],[1,"fw-bold","mb-3","text-light"],[1,"mb-3"],[1,"form-label","text-light"],["type","text","name","personagem","required","",1,"form-control","input-dark",3,"ngModelChange","ngModel"],["name","alinhamento","required","",1,"form-select","input-dark",3,"ngModelChange","ngModel"],["value","","disabled",""],["name","tipoJogador","required","",1,"form-select","input-dark",3,"ngModelChange","ngModel"],[1,"fw-bold","mt-4","text-light"],[1,"atributos-grid-edit","mb-3"],["class","atributo-item-edit",4,"ngFor","ngForOf"],[1,"atributos-grid","mb-3"],[1,"atributo-item"],["alt","Preview",1,"w-100","rounded","detalhe-img","shadow-sm",3,"src"],["type","button",1,"btn","btn-danger","rounded-circle","position-absolute","d-flex","align-items-center","justify-content-center",2,"top","10px","right","10px","width","40px","height","40px",3,"click"],[1,"upload-box"],[1,"fs-1"],["type","file","accept","image/*",1,"d-none",3,"change"],[1,"atributo-item-edit"],[1,"atributo-label","text-center"],[1,"atributo-controls"],["type","button",1,"btn","btn-sm","btn-outline-light",3,"click"],["type","number","min","0",1,"atributo-input",3,"ngModelChange","ngModel","name"],[1,"spinner-border","spinner-border-sm"]],template:function(o,n){o&1&&(e(0,"div",2)(1,"div",3)(2,"div",4),b(3,ae,83,10,"form",5),t()(),e(4,"div",6)(5,"button",7),p("click",function(){return n.cancelar()}),i(6," \u2B05\uFE0F "),t(),e(7,"button",8),b(8,re,2,0,"ng-container",9)(9,le,2,0,"ng-container",9),t()()()),o&2&&(c(3),u("ngIf",n.jogador),c(4),u("disabled",n.salvando),c(),u("ngIf",!n.salvando),c(),u("ngIf",n.salvando))},dependencies:[I,N,A,Q,U,H,X,z,q,G,L,B,K,Y,R,W],styles:[".detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{height:200px;object-fit:cover;border-radius:8px}.upload-box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border:2px dashed #444;border-radius:12px;width:100%;height:140px;background:#1e1e1e;color:#6c757d;cursor:pointer;transition:border .2s ease,color .2s ease}.upload-box[_ngcontent-%COMP%]:hover{border-color:#0d6efd;color:#0d6efd}.input-dark[_ngcontent-%COMP%]{background:#1e1e1e;border:1px solid #444;color:#f8f9fa}.input-dark[_ngcontent-%COMP%]:focus{border-color:#0d6efd;box-shadow:0 0 0 .2rem #0d6efd40;outline:none}.atributos-grid-edit[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}@media (min-width: 768px){.atributos-grid-edit[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (min-width: 992px){.atributos-grid-edit[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.atributo-item-edit[_ngcontent-%COMP%]{background:#2a2a2a;border-radius:6px;padding:8px 10px;display:flex;flex-direction:column;align-items:center}.atributo-label[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa;margin-bottom:6px;text-align:center}.atributo-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:6px}.atributo-input[_ngcontent-%COMP%]{width:60px;text-align:center;font-weight:700;color:#fff;background:#1e1e1e;border:1px solid #444;border-radius:4px;padding:2px 4px}.atributo-input[_ngcontent-%COMP%]:focus{border-color:#0d6efd;outline:none;box-shadow:0 0 0 .2rem #0d6efd40}.atributo-controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:2px 8px;font-size:.9rem;line-height:1}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}@media (min-width: 768px){.atributos-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (min-width: 992px){.atributos-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.atributo-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#2a2a2a;border-radius:6px;padding:6px 10px;text-align:center}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.75rem;color:#f8f9fa}.btn-save[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#218838);border:none;color:#fff;font-weight:600;display:flex;align-items:center;justify-content:center;gap:6px;transition:all .2s ease-in-out}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#34d058,#28a745);transform:translateY(-2px);box-shadow:0 4px 10px #0000004d}.btn-save[_ngcontent-%COMP%]:disabled{background:#444!important;color:#bbb!important;cursor:not-allowed;box-shadow:none}.fab-stack[_ngcontent-%COMP%]{position:fixed;bottom:70px;right:20px;display:flex;flex-direction:column-reverse;gap:15px;z-index:1000}.fab[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;font-size:1.4rem;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 14px #0006;transition:transform .2s ease,background .2s ease;border:none;cursor:pointer}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.08)}.fab-primary[_ngcontent-%COMP%]{background:#0d6efd;color:#fff}.fab-primary[_ngcontent-%COMP%]:hover{background:#0b5ed7}.fab-warning[_ngcontent-%COMP%]{background:#ffc107;color:#000}.fab-warning[_ngcontent-%COMP%]:hover{background:#e0a800}.fab-danger[_ngcontent-%COMP%]{background:#ff4d6d;color:#fff}.fab-danger[_ngcontent-%COMP%]:hover{background:#e63e5b}.jogador-edit-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.jogador-edit-container[_ngcontent-%COMP%]{width:100%;max-width:900px;margin:0 auto}"]})};export{ee as EdicaoJogador};
