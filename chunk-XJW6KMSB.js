import{a as A}from"./chunk-DET3QFJ6.js";import{e as j,g as k,j as z,s as T,w as N}from"./chunk-7SGEPDVZ.js";import{Ab as n,Bb as i,Cb as u,Gb as M,Hb as J,Mb as y,Ob as f,Sa as b,Ta as l,Ya as h,Yb as O,a as _,ac as t,b as v,bc as x,cc as d,db as C,g as p,ib as E,lc as P,pc as F,vb as S,wb as D,xb as w,yb as I,zb as g}from"./chunk-DNZPJZVY.js";var L=r=>({"text-danger fw-bold":r}),U=(r,e)=>e.label;function V(r,e){r&1&&(n(0,"div",4),u(1,"div",8),n(2,"p",9),t(3,"Carregando jogador..."),i()())}function $(r,e){if(r&1&&(M(0),u(1,"img",20),J()),r&2){let a=f(2);l(),g("src",a.jogador.imagem,b)}}function X(r,e){r&1&&(n(0,"div",21),t(1," \u{1F464} "),i())}function q(r,e){if(r&1&&(n(0,"div",19),t(1),n(2,"span"),t(3),i(),n(4,"b"),t(5),i(),n(6,"small",22),t(7),i()()),r&2){let a=e.$implicit;l(),d(" ",a.icon," "),l(2),x(a.label),l(2),x(a.value),l(2),d(" (",a.mod>=0?"+"+a.mod:a.mod,") ")}}function G(r,e){if(r&1&&(n(0,"div",5)(1,"div",10),E(2,$,2,1,"ng-container",11)(3,X,2,0,"ng-template",null,0,F),i(),n(5,"div",12)(6,"h4",13),t(7),i(),n(8,"p",14),t(9),i(),n(10,"ul",15)(11,"li"),t(12,"\u{1F3C5} "),n(13,"span"),t(14,"N\xEDvel:"),i(),t(15),i(),n(16,"li"),t(17,"\u2B50 "),n(18,"span"),t(19,"XP:"),i(),t(20),i(),n(21,"li"),t(22," \u2764\uFE0F "),n(23,"span"),t(24,"Vida:"),i(),n(25,"span",16),t(26),i(),t(27),i(),n(28,"li"),t(29,"\u{1F6E1}\uFE0F "),n(30,"span"),t(31,"Armadura:"),i(),t(32),i(),n(33,"li"),t(34,"\u{1F494} "),n(35,"span"),t(36,"Dano tomado:"),i(),t(37),i(),n(38,"li"),t(39,"\u2728 "),n(40,"span"),t(41,"Fator de cura:"),i(),t(42),i(),n(43,"li"),t(44,"\u{1F6B6}\u200D\u2642\uFE0F "),n(45,"span"),t(46,"Deslocamento:"),i(),t(47),i()(),n(48,"h6",17),t(49,"\u{1F4CA} Atributos"),i(),n(50,"div",18),w(51,q,8,4,"div",19,U),i()()()),r&2){let a=O(4),o=f();l(2),g("ngIf",o.jogador.imagem&&o.jogador.imagem!=="-")("ngIfElse",a),l(5),d("\u{1F9D9} ",o.jogador.personagem),l(2),d("\u2696\uFE0F ",o.jogador.alinhamento||"Sem alinhamento"),l(6),d(" ",o.jogador.nivel),l(5),d(" ",o.jogador.xp),l(5),g("ngClass",P(13,L,o.jogador.vida_atual<=0)),l(),d(" ",o.jogador.vida_atual," "),l(),d(" / ",o.jogador.pontos_de_vida," "),l(5),d(" ",o.jogador.classe_de_armadura),l(5),d(" ",o.jogador.dano_tomado),l(5),d(" ",o.jogador.fator_cura),l(5),d(" ",o.jogador.deslocamento),l(4),I(o.atributos)}}function H(r,e){r&1&&(n(0,"div",6),t(1,"Nenhum jogador encontrado. V\xE1 para o cadastro."),i())}var R=class r{constructor(e){this.router=e}jogador=null;atributos=[];loading=!0;repo=new A("Personagem");ngOnInit(){return p(this,null,function*(){console.log("[Jogador] Iniciando carregamento..."),this.loading=!0;try{let e=N.getUser();if(!e?.email)throw new Error("Usu\xE1rio n\xE3o autenticado.");let a=(yield this.repo.getLocal()).find(m=>m.email===e.email);if(a){console.log("[Jogador] Jogador local encontrado:",a),this.setJogador(a),this.repo.sync().then(m=>p(this,null,function*(){if(m){let s=(yield this.repo.getLocal()).find(c=>c.email===e.email);s&&this.setJogador(s)}}));return}console.log("[Jogador] Nenhum jogador local \u2192 carregando online..."),a=(yield this.repo.forceFetch()).find(m=>m.email===e.email),a?this.setJogador(a):(console.warn("[Jogador] Nenhum jogador encontrado nem online \u2192 cadastro"),this.router.navigate(["/cadastro-jogador"]))}catch(e){console.error("[Jogador] Erro ao carregar Jogador:",e),this.router.navigate(["/login"])}finally{this.loading=!1}})}setJogador(e){let a=e.pontos_de_vida&&e.pontos_de_vida>0?e.pontos_de_vida:(e.energia||0)+(e.constituicao||0),o=Math.floor((e.energia||0)/3),m=Math.floor((e.destreza||0)/3),s=(e.classe_de_armadura||0)>0?a:a-(e.dano_tomado||0);this.jogador=v(_({},e),{pontos_de_vida:a,vida_atual:s,fator_cura:o,deslocamento:m});let c=B=>Math.floor(((B||0)-10)/2);this.atributos=[{label:"For\xE7a",value:e.forca,mod:c(e.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:e.destreza,mod:c(e.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:e.constituicao,mod:c(e.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:e.inteligencia,mod:c(e.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:e.sabedoria,mod:c(e.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:e.carisma,mod:c(e.carisma),icon:"\u{1F60E}"},{label:"Energia",value:e.energia,mod:c(e.energia),icon:"\u26A1"}]}editarJogador(){this.router.navigate(["/edicao-jogador"])}static \u0275fac=function(a){return new(a||r)(h(T))};static \u0275cmp=C({type:r,selectors:[["app-jogador"]],decls:8,vars:1,consts:[["noImagem",""],[1,"jogador-detalhe-wrapper","d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","d-flex","justify-content-center"],[1,"jogador-detalhe-container","w-100"],[1,"text-center","py-5"],[1,"card","detalhe-card","shadow-lg","border-0"],[1,"alert","alert-warning","mt-4"],[1,"fab","fab-primary",3,"click"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"position-relative"],[4,"ngIf","ngIfElse"],[1,"card-body","pb-5"],[1,"fw-bold","mb-1","text-light"],[1,"text-secondary","mb-3"],[1,"info-list","mb-3"],[3,"ngClass"],[1,"fw-bold","mt-3","text-light"],[1,"atributos-grid","compact","mb-3"],[1,"atributo-item"],["alt","Imagem do jogador",1,"card-img-top","detalhe-img",3,"src"],[1,"d-flex","align-items-center","justify-content-center","bg-secondary","text-dark","detalhe-img","fallback-icone"],[1,"text-light"]],template:function(a,o){a&1&&(n(0,"div",1)(1,"div",2)(2,"div",3),S(3,V,4,0,"div",4)(4,G,53,15,"div",5)(5,H,2,0,"div",6),i()(),n(6,"button",7),y("click",function(){return o.editarJogador()}),t(7,"\u270F\uFE0F"),i()()),a&2&&(l(3),D(o.loading?3:o.jogador?4:5))},dependencies:[z,j,k],styles:[".jogador-detalhe-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.jogador-detalhe-container[_ngcontent-%COMP%]{width:100%;max-width:900px;margin:0 auto}.detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{height:220px;object-fit:cover;width:100%}.fallback-icone[_ngcontent-%COMP%]{font-size:3rem}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:.95rem}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:#f1f1f1}.info-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px 14px;font-size:.9rem;color:#f1f1f1}.atributo-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.9rem;background:#2a2a2a;border-radius:6px;padding:6px 10px;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#ccc}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#f8f9fa}.fab[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;font-size:1.6rem;display:flex;align-items:center;justify-content:center;position:fixed;bottom:70px;right:20px;background:#0d6efd;color:#fff;box-shadow:0 4px 14px #0006;transition:transform .2s ease;border:none}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.08)}@media (min-width: 992px){.fab[_ngcontent-%COMP%]{right:calc(50% - 430px)}}"]})};export{R as Jogador};
