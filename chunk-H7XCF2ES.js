import{a as v}from"./chunk-FJZA3HMC.js";import"./chunk-W7DVKRY2.js";import"./chunk-HS244SCX.js";import{Ga as s,Ha as a,Ia as r,Ib as C,Ja as _,Jb as B,Mb as w,Na as J,Oa as F,Ta as u,Tb as T,Vb as j,a as I,b as S,d as h,fb as o,gb as m,ha as E,hb as p,ia as n,ib as b,ma as x,qa as y,ua as g}from"./chunk-ILJPX4RU.js";function M(i,t){i&1&&(a(0,"div",5),_(1,"div",6),a(2,"p",7),o(3,"Carregando personagem..."),r()())}function R(i,t){if(i&1&&(J(0),_(1,"img",18),F()),i&2){let e=u(2);n(),s("src",e.jogador.imagem,E)}}function O(i,t){if(i&1&&(a(0,"div",19)(1,"div",20)(2,"div"),o(3),r(),a(4,"div"),o(5),a(6,"small"),o(7),r()()()()),i&2){let e=t.$implicit;n(3),b("",e.icon," ",e.label),n(2),p("",e.value," "),n(2),p("(",e.mod>=0?"+"+e.mod:e.mod,")")}}function q(i,t){if(i&1&&(a(0,"p",23),o(1),r()),i&2){let e=u(3);n(),m(e.jogador.descricao)}}function A(i,t){if(i&1&&(a(0,"p")(1,"b"),o(2,"\u2694\uFE0F Ataques:"),r(),o(3),r()),i&2){let e=u(3);n(3),p(" ",e.jogador.ataques)}}function N(i,t){if(i&1&&(a(0,"div",21),g(1,q,2,1,"p",22)(2,A,4,1,"p",9),r()),i&2){let e=u(2);n(),s("ngIf",e.jogador.descricao),n(),s("ngIf",e.jogador.ataques)}}function k(i,t){if(i&1&&(a(0,"div",8),g(1,R,2,1,"ng-container",9),a(2,"div",10)(3,"h4",11),o(4),r(),a(5,"p",12),o(6),r(),a(7,"ul",13)(8,"li",14),o(9,"\u2B50 XP: "),a(10,"b"),o(11),r()(),a(12,"li",14),o(13,"\u2764\uFE0F Vida: "),a(14,"b"),o(15),r(),o(16," | \u{1F6E1}\uFE0F Armadura: "),a(17,"b"),o(18),r()(),a(19,"li",14),o(20,"\u{1F494} Dano tomado: "),a(21,"b"),o(22),r()(),a(23,"li",14),o(24,"\u2728 Fator de cura: "),a(25,"b"),o(26),r()(),a(27,"li",14),o(28,"\u{1F6B6}\u200D\u2642\uFE0F Deslocamento: "),a(29,"b"),o(30),r()()(),a(31,"div",15),g(32,O,8,4,"div",16),r(),g(33,N,3,2,"div",17),r()()),i&2){let e=u();n(),s("ngIf",e.jogador.imagem),n(3),b(" ",e.jogador.email?"\u{1F9D9}":"\u{1F479}"," ",e.jogador.personagem," "),n(2),p(" \u2696\uFE0F ",e.jogador.alinhamento||"Sem alinhamento"," "),n(5),m(e.jogador.xp),n(4),m(e.jogador.pontos_de_vida),n(3),m(e.jogador.classe_de_armadura),n(4),m(e.jogador.dano_tomado),n(4),m(e.jogador.fator_cura),n(4),m(e.jogador.deslocamento),n(2),s("ngForOf",e.atributos),n(),s("ngIf",!e.jogador.email)}}function P(i,t){i&1&&(a(0,"div",24),o(1," Nenhum personagem encontrado. "),r())}var z=class i{constructor(t,e){this.route=t;this.router=e}jogador=null;atributos=[];loading=!0;ngOnInit(){return h(this,null,function*(){let t=this.route.snapshot.paramMap.get("id");if(!t){this.router.navigate(["/batalha"]);return}try{let l=(yield v.getLocalJogadores()).find(c=>String(c.id)===String(t))||null;if(l)this.setJogador(l),v.syncJogadores().then(c=>h(this,null,function*(){if(c){let d=(yield v.getLocalJogadores()).find(f=>String(f.id)===String(t));d&&this.setJogador(d)}}));else{let c=yield v.forceFetchJogador();c&&String(c.id)===String(t)&&this.setJogador(c)}}catch(e){console.error("[JogadorDetalhesBatalha] Erro:",e)}finally{this.loading=!1}})}setJogador(t){let e=t.pontos_de_vida&&t.pontos_de_vida>0?t.pontos_de_vida:t.energia+t.constituicao,l=Math.floor(t.energia/3),c=e+t.classe_de_armadura,D=Math.floor(t.destreza/3);this.jogador=S(I({},t),{pontos_de_vida:e,fator_cura:l,vida_total:c,deslocamento:D});let d=f=>Math.floor((f-10)/2);this.atributos=[{label:"For\xE7a",value:t.forca,mod:d(t.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:t.destreza,mod:d(t.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:t.constituicao,mod:d(t.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:t.inteligencia,mod:d(t.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:t.sabedoria,mod:d(t.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:t.carisma,mod:d(t.carisma),icon:"\u{1F60E}"},{label:"Energia",value:t.energia,mod:d(t.energia),icon:"\u26A1"}]}editarJogador(){if(this.jogador){if(!this.jogador.email){this.router.navigate(["/cadastro-npc",this.jogador.id],{queryParams:{returnUrl:this.router.url}});return}this.router.navigate(["/cadastro-jogador",this.jogador.id],{queryParams:{returnUrl:this.router.url}})}}static \u0275fac=function(e){return new(e||i)(x(T),x(j))};static \u0275cmp=y({type:i,selectors:[["app-jogador-detalhes-batalha"]],decls:5,vars:3,consts:[[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","pb-5"],["class","text-center py-5",4,"ngIf"],["class","card bg-dark text-light border-0 shadow-lg",4,"ngIf"],["class","alert alert-warning mt-4",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"card","bg-dark","text-light","border-0","shadow-lg"],[4,"ngIf"],[1,"card-body","pb-5"],[1,"card-title","fw-bold"],[1,"card-subtitle","text-light","mb-3"],[1,"list-group","list-group-flush"],[1,"list-group-item","bg-dark","text-light","border-0"],[1,"row","row-cols-2","g-2","mt-3"],["class","col",4,"ngFor","ngForOf"],["class","mt-3",4,"ngIf"],["alt","Imagem do personagem",1,"card-img-top","object-fit-cover",2,"max-height","300px",3,"src"],[1,"col"],[1,"p-2","rounded","bg-secondary","text-light","text-center","fw-bold","d-flex","flex-column","align-items-center"],[1,"mt-3"],["class","fst-italic",4,"ngIf"],[1,"fst-italic"],[1,"alert","alert-warning","mt-4"]],template:function(e,l){e&1&&(a(0,"div",0)(1,"div",1),g(2,M,4,0,"div",2)(3,k,34,12,"div",3)(4,P,2,0,"div",4),r()()),e&2&&(n(2),s("ngIf",l.loading),n(),s("ngIf",!l.loading&&l.jogador),n(),s("ngIf",!l.loading&&!l.jogador))},dependencies:[w,C,B],encapsulation:2})};export{z as JogadorDetalhesBatalha};
