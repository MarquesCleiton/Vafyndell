import{a as s}from"./chunk-QXDASCMK.js";import"./chunk-2CFPKSUU.js";import{e as P,g as F,j as z,s as k,v as j}from"./chunk-YWTK67XE.js";import{$b as l,Db as I,Eb as M,Jb as O,Lb as f,Pa as b,Qa as o,Va as h,Zb as a,_b as x,a as _,ab as C,b as v,d as p,fb as E,ic as w,sb as S,tb as J,ub as D,vb as y,wb as g,xb as n,yb as i,zb as u}from"./chunk-DIJLFEPN.js";var R=r=>({"text-danger fw-bold":r}),B=(r,e)=>e.label;function L(r,e){r&1&&(n(0,"div",2),u(1,"div",6),n(2,"p",7),a(3,"Carregando jogador..."),i()())}function U(r,e){if(r&1&&(I(0),u(1,"img",17),M()),r&2){let t=f(2);o(),g("src",t.jogador.imagem,b)}}function V(r,e){if(r&1&&(n(0,"div",16),a(1),n(2,"span"),a(3),i(),n(4,"b"),a(5),i(),n(6,"small",18),a(7),i()()),r&2){let t=e.$implicit;o(),l(" ",t.icon," "),o(2),x(t.label),o(2),x(t.value),o(2),l("(",t.mod>=0?"+"+t.mod:t.mod,")")}}function $(r,e){if(r&1&&(n(0,"div",3),E(1,U,2,1,"ng-container",8),n(2,"div",9)(3,"h4",10),a(4),i(),n(5,"p",11),a(6),i(),n(7,"ul",12)(8,"li"),a(9,"\u{1F3C5} "),n(10,"span"),a(11,"N\xEDvel:"),i(),a(12),i(),n(13,"li"),a(14,"\u2B50 "),n(15,"span"),a(16,"XP:"),i(),a(17),i(),n(18,"li"),a(19," \u2764\uFE0F "),n(20,"span"),a(21,"Vida:"),i(),n(22,"span",13),a(23),i(),a(24),i(),n(25,"li"),a(26,"\u{1F6E1}\uFE0F "),n(27,"span"),a(28,"Armadura:"),i(),a(29),i(),n(30,"li"),a(31,"\u{1F494} "),n(32,"span"),a(33,"Dano tomado:"),i(),a(34),i(),n(35,"li"),a(36,"\u2728 "),n(37,"span"),a(38,"Fator de cura:"),i(),a(39),i(),n(40,"li"),a(41,"\u{1F6B6}\u200D\u2642\uFE0F "),n(42,"span"),a(43,"Deslocamento:"),i(),a(44),i()(),n(45,"h6",14),a(46,"\u{1F4CA} Atributos"),i(),n(47,"div",15),D(48,V,8,4,"div",16,B),i()()()),r&2){let t=f();o(),g("ngIf",t.jogador.imagem),o(3),l("\u{1F9D9} ",t.jogador.personagem),o(2),l("\u2696\uFE0F ",t.jogador.alinhamento),o(6),l(" ",t.jogador.nivel),o(5),l(" ",t.jogador.xp),o(5),g("ngClass",w(12,R,t.jogador.vida_atual<=0)),o(),l(" ",t.jogador.vida_atual," "),o(),l(" / ",t.jogador.pontos_de_vida," "),o(5),l(" ",t.jogador.classe_de_armadura),o(5),l(" ",t.jogador.dano_tomado),o(5),l(" ",t.jogador.fator_cura),o(5),l(" ",t.jogador.deslocamento),o(4),y(t.atributos)}}function X(r,e){r&1&&(n(0,"div",4),a(1,"Nenhum jogador encontrado. V\xE1 para o cadastro."),i())}var N=class r{constructor(e){this.router=e}jogador=null;atributos=[];loading=!0;ngOnInit(){return p(this,null,function*(){console.log("[Jogador] Iniciando carregamento..."),this.loading=!0;try{if(!j.getUser()?.email)throw new Error("Usu\xE1rio n\xE3o autenticado.");let t=yield s.getLocalJogador();if(t){console.log("[Jogador] Jogador local encontrado:",t),this.setJogador(t),s.syncJogadores().then(d=>p(this,null,function*(){if(d){let m=yield s.getLocalJogador();m&&this.setJogador(m)}}));return}console.log("[Jogador] Nenhum jogador local \u2192 carregando online..."),t=yield s.forceFetchJogador(),t?this.setJogador(t):(console.warn("[Jogador] Nenhum jogador encontrado nem online \u2192 cadastro"),this.router.navigate(["/cadastro-jogador"]))}catch(e){console.error("[Jogador] Erro ao carregar Jogador:",e)}finally{this.loading=!1}})}setJogador(e){let t=e.pontos_de_vida&&e.pontos_de_vida>0?e.pontos_de_vida:e.energia+e.constituicao,d=Math.floor(e.energia/3),m=Math.floor(e.destreza/3),T=e.classe_de_armadura>0?t:t-(e.dano_tomado||0);this.jogador=v(_({},e),{pontos_de_vida:t,vida_atual:T,fator_cura:d,deslocamento:m});let c=A=>Math.floor((A-10)/2);this.atributos=[{label:"For\xE7a",value:e.forca,mod:c(e.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:e.destreza,mod:c(e.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:e.constituicao,mod:c(e.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:e.inteligencia,mod:c(e.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:e.sabedoria,mod:c(e.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:e.carisma,mod:c(e.carisma),icon:"\u{1F60E}"},{label:"Energia",value:e.energia,mod:c(e.energia),icon:"\u26A1"}]}editarJogador(){this.router.navigate(["/edicao-jogador"])}static \u0275fac=function(t){return new(t||r)(h(k))};static \u0275cmp=C({type:r,selectors:[["app-jogador"]],decls:6,vars:1,consts:[[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","pb-5"],[1,"text-center","py-5"],[1,"card","detalhe-card","shadow-lg","border-0"],[1,"alert","alert-warning","mt-4"],[1,"fab","fab-primary",3,"click"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[4,"ngIf"],[1,"card-body","pb-5"],[1,"fw-bold","mb-1","text-light"],[1,"text-secondary","mb-3"],[1,"info-list","mb-3"],[3,"ngClass"],[1,"fw-bold","mt-3","text-light"],[1,"atributos-grid","compact","mb-3"],[1,"atributo-item"],["alt","Imagem do jogador",1,"card-img-top","detalhe-img",3,"src"],[1,"text-light"]],template:function(t,d){t&1&&(n(0,"div",0)(1,"div",1),S(2,L,4,0,"div",2)(3,$,50,14,"div",3)(4,X,2,0,"div",4),i(),n(5,"button",5),O("click",function(){return d.editarJogador()}),i()()),t&2&&(o(2),J(d.loading?2:d.jogador?3:4))},dependencies:[z,P,F],styles:[".detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{max-height:220px;object-fit:cover}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:.95rem}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:#f1f1f1}.info-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#ddd}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px 12px;font-size:.9rem;color:#f1f1f1}.atributo-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;white-space:nowrap;font-size:.9rem;background:#2a2a2a;border-radius:6px;padding:4px 8px}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#ccc;margin-right:2px}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#aaa;margin-left:2px}.fab[_ngcontent-%COMP%]{position:fixed;bottom:80px;right:20px;width:60px;height:60px;border-radius:50%;font-size:1.5rem;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 14px #0006}.fab-primary[_ngcontent-%COMP%]{background:#0d6efd;color:#fff}.fab-primary[_ngcontent-%COMP%]:hover{background:#0b5ed7}"]})};export{N as Jogador};
