import{a as f}from"./chunk-ABDDRN72.js";import"./chunk-LACG63BB.js";import{Ga as l,Ha as i,Ia as n,Ja as h,Jb as O,Kb as P,Lb as w,Na as S,Oa as y,Ob as F,Ta as p,Vb as B,Xb as j,a as D,b as E,d as _,fb as a,gb as u,ha as C,hb as d,ia as r,ib as M,ma as v,qa as I,qb as J,ua as g}from"./chunk-MZUA6OGT.js";var T=o=>({"text-danger fw-bold":o});function q(o,e){o&1&&(i(0,"div",5),h(1,"div",6),i(2,"p",7),a(3,"Carregando personagem..."),n()())}function A(o,e){if(o&1&&(S(0),h(1,"img",19),y()),o&2){let t=p(2);r(),l("src",t.jogador.imagem,C)}}function R(o,e){if(o&1&&(i(0,"div",20),a(1),i(2,"span"),a(3),n(),i(4,"b"),a(5),n(),i(6,"small",21),a(7),n()()),o&2){let t=e.$implicit;r(),d(" ",t.icon," "),r(2),u(t.label),r(2),u(t.value),r(2),d("(",t.mod>=0?"+"+t.mod:t.mod,")")}}function N(o,e){if(o&1&&(i(0,"p",27),a(1),n()),o&2){let t=p(3);r(),u(t.jogador.descricao)}}function k(o,e){o&1&&(i(0,"h6",28),a(1,"\u2694\uFE0F Ataques"),n())}function U(o,e){if(o&1&&(i(0,"p",29),a(1),n()),o&2){let t=p(3);r(),u(t.jogador.ataques)}}function L(o,e){if(o&1&&(i(0,"div",22)(1,"h6",23),a(2,"\u{1F4DD} Descri\xE7\xE3o"),n(),g(3,N,2,1,"p",24)(4,k,2,0,"h6",25)(5,U,2,1,"p",26),n()),o&2){let t=p(2);r(3),l("ngIf",t.jogador.descricao),r(),l("ngIf",t.jogador.ataques),r(),l("ngIf",t.jogador.ataques)}}function V(o,e){if(o&1&&(i(0,"div",8),g(1,A,2,1,"ng-container",9),i(2,"div",10)(3,"h4",11),a(4),n(),i(5,"p",12),a(6),n(),i(7,"ul",13)(8,"li"),a(9,"\u2B50 "),i(10,"span"),a(11,"XP:"),n(),a(12),n(),i(13,"li"),a(14," \u{1F496} "),i(15,"span"),a(16,"Vida Total:"),n(),i(17,"span",14),a(18),n(),a(19),n(),i(20,"li"),a(21,"\u2764\uFE0F "),i(22,"span"),a(23,"Vida:"),n(),a(24),n(),i(25,"li"),a(26,"\u{1F6E1}\uFE0F "),i(27,"span"),a(28,"Armadura:"),n(),a(29),n(),i(30,"li"),a(31,"\u{1F494} "),i(32,"span"),a(33,"Dano tomado:"),n(),a(34),n(),i(35,"li"),a(36,"\u2728 "),i(37,"span"),a(38,"Fator de cura:"),n(),a(39),n(),i(40,"li"),a(41,"\u{1F6B6}\u200D\u2642\uFE0F "),i(42,"span"),a(43,"Deslocamento:"),n(),a(44),n()(),i(45,"h6",15),a(46,"\u{1F4CA} Atributos"),n(),i(47,"div",16),g(48,R,8,4,"div",17),n(),g(49,L,6,3,"div",18),n()()),o&2){let t=p();r(),l("ngIf",t.jogador.imagem),r(3),M(" ",t.jogador.email?"\u{1F9D9}":"\u{1F479}"," ",t.jogador.personagem," "),r(2),d(" \u2696\uFE0F ",t.jogador.alinhamento||"Sem alinhamento"," "),r(6),d(" ",t.jogador.xp),r(5),l("ngClass",J(15,T,t.jogador.vida_total<=0)),r(),d(" ",t.jogador.vida_total," "),r(),d(" / ",t.jogador.pontos_de_vida+t.jogador.classe_de_armadura," "),r(5),d(" ",t.jogador.pontos_de_vida),r(5),d(" ",t.jogador.classe_de_armadura),r(5),d(" ",t.jogador.dano_tomado),r(5),d(" ",t.jogador.fator_cura),r(5),d(" ",t.jogador.deslocamento),r(4),l("ngForOf",t.atributos),r(),l("ngIf",!t.jogador.email)}}function X(o,e){o&1&&(i(0,"div",30),a(1," Nenhum personagem encontrado. "),n())}var z=class o{constructor(e,t){this.route=e;this.router=t}jogador=null;atributos=[];loading=!0;ngOnInit(){return _(this,null,function*(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.router.navigate(["/batalha"]);return}try{let s=(yield f.getLocalJogadores()).find(m=>String(m.id)===String(e))||null;if(s)this.setJogador(s),f.syncJogadores().then(m=>_(this,null,function*(){if(m){let c=(yield f.getLocalJogadores()).find(x=>String(x.id)===String(e));c&&this.setJogador(c)}}));else{let m=yield f.forceFetchJogador();m&&String(m.id)===String(e)&&this.setJogador(m)}}catch(t){console.error("[JogadorDetalhesBatalha] Erro:",t)}finally{this.loading=!1}})}setJogador(e){let t=e.pontos_de_vida&&e.pontos_de_vida>0?e.pontos_de_vida:e.energia+e.constituicao,s=Math.floor(e.energia/3),m=t+e.classe_de_armadura-(e.dano_tomado||0),b=Math.floor(e.destreza/3);this.jogador=E(D({},e),{pontos_de_vida:t,fator_cura:s,vida_total:m,deslocamento:b});let c=x=>Math.floor((x-10)/2);this.atributos=[{label:"For\xE7a",value:e.forca,mod:c(e.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:e.destreza,mod:c(e.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:e.constituicao,mod:c(e.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:e.inteligencia,mod:c(e.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:e.sabedoria,mod:c(e.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:e.carisma,mod:c(e.carisma),icon:"\u{1F60E}"},{label:"Energia",value:e.energia,mod:c(e.energia),icon:"\u26A1"}]}editarJogador(){if(this.jogador){if(!this.jogador.email){this.router.navigate(["/cadastro-npc",this.jogador.id],{queryParams:{returnUrl:this.router.url}});return}this.router.navigate(["/cadastro-jogador",this.jogador.id],{queryParams:{returnUrl:this.router.url}})}}static \u0275fac=function(t){return new(t||o)(v(B),v(j))};static \u0275cmp=I({type:o,selectors:[["app-jogador-detalhes-batalha"]],decls:5,vars:3,consts:[[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","pb-5"],["class","text-center py-5",4,"ngIf"],["class","card detalhe-card shadow-lg border-0",4,"ngIf"],["class","alert alert-warning mt-4",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"card","detalhe-card","shadow-lg","border-0"],[4,"ngIf"],[1,"card-body","pb-5"],[1,"fw-bold","mb-1","text-light"],[1,"text-secondary","mb-3"],[1,"info-list","mb-3"],[3,"ngClass"],[1,"fw-bold","mt-3","text-light"],[1,"atributos-grid","compact","mb-3"],["class","atributo-item",4,"ngFor","ngForOf"],["class","mt-3",4,"ngIf"],["alt","Imagem do personagem",1,"card-img-top","detalhe-img",3,"src"],[1,"atributo-item"],[1,"text-light"],[1,"mt-3"],[1,"fw-bold","text-light"],["class","descricao-text",4,"ngIf"],["class","fw-bold text-light mt-3",4,"ngIf"],["class","ataques-text",4,"ngIf"],[1,"descricao-text"],[1,"fw-bold","text-light","mt-3"],[1,"ataques-text"],[1,"alert","alert-warning","mt-4"]],template:function(t,s){t&1&&(i(0,"div",0)(1,"div",1),g(2,q,4,0,"div",2)(3,V,50,17,"div",3)(4,X,2,0,"div",4),n()()),t&2&&(r(2),l("ngIf",s.loading),r(),l("ngIf",!s.loading&&s.jogador),r(),l("ngIf",!s.loading&&!s.jogador))},dependencies:[F,O,P,w],styles:[".detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{max-height:220px;object-fit:cover}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:.95rem}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:#f1f1f1}.info-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px 12px;font-size:.9rem;color:#f1f1f1}.atributo-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;white-space:nowrap;font-size:.9rem;background:#2a2a2a;border-radius:6px;padding:4px 8px}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#ccc;margin-right:2px}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#aaa;margin-left:2px}.descricao-text[_ngcontent-%COMP%]{color:#ddd;font-size:.95rem}.ataques-text[_ngcontent-%COMP%]{color:#f8d775;font-size:.9rem}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#f8f9fa!important}"]})};export{z as JogadorDetalhesBatalha};
