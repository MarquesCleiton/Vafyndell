import{a as $}from"./chunk-CDJK5DZR.js";import{a as O}from"./chunk-J5FBOTGS.js";import{f as A,h as V}from"./chunk-SEBSZRO5.js";import{e as F,h as z,i as j,q}from"./chunk-IJWXOQAR.js";import{Ab as l,Bb as r,Cb as a,Db as _,Hb as u,Ib as f,Jb as y,Nb as x,Pb as m,Sa as I,Ua as o,Za as E,Zb as w,ac as k,bc as c,dc as g,eb as P,ec as M,g as C,jb as s,jc as T,kc as R,la as b,ma as h,rc as S}from"./chunk-O42C4TWY.js";function U(t,n){t&1&&(r(0,"div",13),_(1,"div",14),r(2,"p",15),c(3,"Carregando item..."),a()())}function G(t,n){if(t&1){let e=y();u(0),r(1,"img",31),x("click",function(){b(e);let d=m(2);return h(d.abrirImagem(d.item.imagem))}),a(),f()}if(t&2){let e=m(2);o(),l("alt",T(e.item.nome||"Item"))("src",e.item.imagem,I)}}function H(t,n){t&1&&(r(0,"div",32),c(1," \u{1F4E6} "),a())}function J(t,n){if(t&1&&(r(0,"p",33),c(1," \u2728 "),r(2,"b"),c(3,"Efeito:"),a(),c(4),a()),t&2){let e=m(2);o(4),g(" ",e.item.efeito," ")}}function K(t,n){if(t&1&&(r(0,"p",34),c(1," \u26A0\uFE0F "),r(2,"b"),c(3,"Colateral:"),a(),c(4),a()),t&2){let e=m(2);o(4),g(" ",e.item.colateral," ")}}function Q(t,n){if(t&1&&(r(0,"p",35),c(1," \u{1F4DD} "),r(2,"b"),c(3,"Descri\xE7\xE3o:"),a(),c(4),a()),t&2){let e=m(2);o(4),g(" ",e.item.descricao," ")}}function W(t,n){if(t&1&&(u(0),_(1,"img",47),f()),t&2){let e=m().$implicit;o(),l("src",e.item.imagem,I)}}function X(t,n){t&1&&(r(0,"span",48),c(1,"\u{1F4E6}"),a())}function Y(t,n){if(t&1){let e=y();r(0,"div",43)(1,"div",44),s(2,W,2,1,"ng-container",22)(3,X,2,0,"ng-template",null,1,S),r(5,"span",45),x("click",function(){let d=b(e).$implicit,v=m(3);return h(v.abrirItem(d.item.id))}),c(6),a()(),r(7,"span",46),c(8),a()()}if(t&2){let e=n.$implicit,i=w(4);o(2),l("ngIf",e.item.imagem&&(e.item==null?null:e.item.imagem)!=="-")("ngIfElse",i),o(4),g(" ",e.item.nome||"Ingrediente"," "),o(2),g("x",e.quantidade)}}function Z(t,n){if(t&1&&(r(0,"div",36)(1,"h5",37),c(2,"\u{1F963} Receita"),a(),r(3,"div",38),s(4,Y,9,4,"div",39),a(),r(5,"div",40)(6,"div",41),c(7,"\u2692\uFE0F Produz"),a(),r(8,"div",42),c(9),a()()()),t&2){let e=m(2);o(4),l("ngForOf",e.ingredientesDetalhados),o(5),M(" ",e.item.quantidade_fabricavel||1," ",e.item.unidade_medida||"unidade(s)"," ")}}function ee(t,n){if(t&1&&(u(0),_(1,"img",47),f()),t&2){let e=m().$implicit;o(),l("src",e.produto.imagem,I)}}function te(t,n){t&1&&(r(0,"span",48),c(1,"\u{1F4E6}"),a())}function ie(t,n){if(t&1){let e=y();r(0,"div",43)(1,"div",44),s(2,ee,2,1,"ng-container",22)(3,te,2,0,"ng-template",null,2,S),r(5,"span",45),x("click",function(){let d=b(e).$implicit,v=m(3);return h(v.abrirItem(d.produto.id))}),c(6),a()()()}if(t&2){let e=n.$implicit,i=w(4);o(2),l("ngIf",e.produto.imagem&&e.produto.imagem!=="-")("ngIfElse",i),o(4),g(" ",e.produto.nome||"Produto"," ")}}function ne(t,n){if(t&1&&(r(0,"div",36)(1,"h5",37),c(2,"\u{1F517} Receitas associadas"),a(),r(3,"div",38),s(4,ie,7,3,"div",39),a()()),t&2){let e=m(2);o(4),l("ngForOf",e.receitasAssociadas)}}function ae(t,n){if(t&1&&(r(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19)(4,"h4",20),c(5),a()(),r(6,"div",21),s(7,G,2,3,"ng-container",22)(8,H,2,0,"ng-template",null,0,S),a(),r(10,"div",23)(11,"p",24)(12,"b"),c(13,"\u{1F4C2} Categoria:"),a(),c(14),a(),r(15,"p",24)(16,"b"),c(17,"\u{1F331} Origem:"),a(),c(18),a(),r(19,"p",24)(20,"b"),c(21,"\u{1F48E} Raridade:"),a(),r(22,"span"),c(23),a()(),r(24,"p",25)(25,"b"),c(26,"\u2696\uFE0F Peso:"),a(),c(27),a(),_(28,"hr",26),s(29,J,5,1,"p",27)(30,K,5,1,"p",28)(31,Q,5,1,"p",29),a(),s(32,Z,10,3,"div",30)(33,ne,5,1,"div",30),a()()()),t&2){let e=w(9),i=m();o(5),g(" \u{1F4E6} ",i.item.nome||"Sem nome"," "),o(2),l("ngIf",i.item.imagem&&i.item.imagem!=="-")("ngIfElse",e),o(7),g(" ",i.item.categoria),o(4),g(" ",i.item.origem),o(4),k(R("raridade ",i.getRaridadeClass(i.item.raridade))),o(),g(" ",i.item.raridade||"Comum"," "),o(4),M(" ",i.item.peso," ",i.item.unidade_medida),o(2),l("ngIf",i.item.efeito),o(),l("ngIf",i.item.colateral),o(),l("ngIf",i.item.descricao),o(),l("ngIf",i.ingredientesDetalhados.length>0),o(),l("ngIf",i.receitasAssociadas.length>0)}}function oe(t,n){t&1&&(u(0),c(1,"\u270F\uFE0F"),f())}function re(t,n){t&1&&(u(0),_(1,"span",49),f())}function ce(t,n){t&1&&(u(0),c(1,"\u{1F5D1}\uFE0F"),f())}function le(t,n){t&1&&(u(0),_(1,"span",49),f())}var L=class t{constructor(n,e,i){this.route=n;this.router=e;this.location=i}item=null;ingredientesDetalhados=[];receitasAssociadas=[];carregando=!0;processandoEditar=!1;processandoExcluir=!1;imagemSelecionada=null;modalAberto=!1;repoCatalogo=new O("Catalogo");repoReceitas=new O("Receitas");ngOnInit(){return C(this,null,function*(){this.route.paramMap.subscribe(n=>C(this,null,function*(){let e=n.get("id");if(!e){this.router.navigate(["/catalogo"]);return}yield this.carregarItem(e)}))})}carregarItem(n){return C(this,null,function*(){try{console.log("[ItemCatalogo] Carregando item",n),this.carregando=!0;let e=yield this.repoCatalogo.getById(n,!0);if(e&&(this.item=e,yield this.carregarReceita(n)),Promise.all([this.repoCatalogo.sync(),this.repoReceitas.sync()]).then(()=>C(this,null,function*(){let i=yield this.repoCatalogo.getById(n,!0);i&&(this.item=i,yield this.carregarReceita(n))})),!e){let d=(yield this.repoCatalogo.forceFetch()).find(v=>String(v.id)===n);d?(this.item=d,yield this.carregarReceita(n,!0)):this.router.navigate(["/catalogo"])}}catch(e){console.error("[ItemCatalogo] Erro ao carregar item:",e)}finally{this.carregando=!1}})}carregarReceita(n,e=!1){return C(this,null,function*(){let i=e?yield this.repoReceitas.forceFetch():yield this.repoReceitas.getLocal(),d=yield this.repoCatalogo.getLocal(),v=i.filter(p=>String(p.fabricavel)===String(n));this.ingredientesDetalhados=v.map(p=>({item:d.find(D=>String(D.id)===String(p.catalogo))||{},quantidade:p.quantidade}));let B=i.filter(p=>String(p.catalogo)===String(n));this.receitasAssociadas=B.map(p=>({produto:d.find(D=>String(D.id)===String(p.fabricavel))||{},quantidade:p.quantidade}))})}cancelar(){this.location.back()}editarItem(){this.item&&(this.processandoEditar=!0,setTimeout(()=>{this.router.navigate(["/cadastro-item-catalogo",this.item.id]),this.processandoEditar=!1},300))}excluirItem(){return C(this,null,function*(){if(!(!this.item||!confirm(`\u{1F5D1}\uFE0F Deseja excluir o item "${this.item.nome}"?`))){this.processandoExcluir=!0;try{yield this.repoCatalogo.delete(this.item.id),alert("\u2705 Item exclu\xEDdo com sucesso!"),this.router.navigate(["/catalogo"])}catch(e){console.error("[ItemCatalogo] Erro ao excluir item:",e),alert("\u274C Erro ao excluir item. Veja o console.")}finally{this.processandoExcluir=!1}}})}getRaridadeClass(n){switch((n||"").toLowerCase()){case"comum":return"raridade-comum";case"incomum":return"raridade-incomum";case"raro":return"raridade-raro";case"\xE9pico":case"epico":return"raridade-epico";case"lend\xE1rio":case"lendario":return"raridade-lendario";default:return"raridade-comum"}}abrirImagem(n){this.imagemSelecionada=n,this.modalAberto=!0}abrirItem(n){console.log(n),n&&this.router.navigate(["/item-catalogo",String(n)])}static \u0275fac=function(e){return new(e||t)(E(A),E(V),E(F))};static \u0275cmp=P({type:t,selectors:[["app-item-catalogo"]],decls:14,vars:10,consts:[["noImagem",""],["noImgIng",""],["noImgProduto",""],[1,"item-detalhe-wrapper","d-flex","flex-column","min-vh-100","bg-dark","text-light","pb-5","mb-5"],["class","text-center py-5",4,"ngIf"],["class","flex-grow-1 p-3 d-flex justify-content-center",4,"ngIf"],[1,"fab-stack"],[1,"fab","fab-warning",3,"click","disabled"],[4,"ngIf"],[1,"fab","fab-danger",3,"click","disabled"],[1,"fab","fab-primary",3,"click"],[1,"mb-5","py-5"],[3,"fecharModal","imagem","aberto"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"flex-grow-1","p-3","d-flex","justify-content-center"],[1,"item-detalhe-container","w-100"],[1,"card","detalhe-card","shadow-lg","border-0"],[1,"card-body","p-3","border-bottom","d-flex","align-items-center","gap-2"],[1,"fw-bold","mb-0","text-capitalize","text-light"],[1,"position-relative"],[4,"ngIf","ngIfElse"],[1,"card-body"],[1,"text-light","mb-1"],[1,"text-light","mb-3"],[1,"border-secondary"],["class","mb-1 text-info",4,"ngIf"],["class","mb-1 text-danger",4,"ngIf"],["class","fst-italic text-light descricao-text",4,"ngIf"],["class","ingredientes-wrapper p-3 border-top",4,"ngIf"],[1,"card-img-top","detalhe-img",3,"click","src","alt"],[1,"d-flex","align-items-center","justify-content-center","bg-secondary","text-dark","detalhe-img","fallback-icone"],[1,"mb-1","text-info"],[1,"mb-1","text-danger"],[1,"fst-italic","text-light","descricao-text"],[1,"ingredientes-wrapper","p-3","border-top"],[1,"fw-bold","text-light","mb-3"],[1,"ingredientes-grid","mb-3"],["class","ingrediente-card",4,"ngFor","ngForOf"],[1,"producao-card","text-center"],[1,"titulo"],[1,"quantidade"],[1,"ingrediente-card"],[1,"d-flex","align-items-center","gap-2"],[1,"nome","link-hover",3,"click"],[1,"qtd"],[1,"thumb-mini","rounded",3,"src"],[1,"fs-5"],[1,"spinner-border","spinner-border-sm"]],template:function(e,i){e&1&&(r(0,"div",3),s(1,U,4,0,"div",4)(2,ae,34,16,"div",5),r(3,"div",6)(4,"button",7),x("click",function(){return i.editarItem()}),s(5,oe,2,0,"ng-container",8)(6,re,2,0,"ng-container",8),a(),r(7,"button",9),x("click",function(){return i.excluirItem()}),s(8,ce,2,0,"ng-container",8)(9,le,2,0,"ng-container",8),a(),r(10,"button",10),x("click",function(){return i.cancelar()}),c(11," \u2B05\uFE0F "),a()()(),_(12,"div",11),r(13,"app-image-modal",12),x("fecharModal",function(){return i.modalAberto=!1}),a()),e&2&&(o(),l("ngIf",i.carregando),o(),l("ngIf",!i.carregando&&i.item),o(2),l("disabled",i.processandoEditar),o(),l("ngIf",!i.processandoEditar),o(),l("ngIf",i.processandoEditar),o(),l("disabled",i.processandoExcluir),o(),l("ngIf",!i.processandoExcluir),o(),l("ngIf",i.processandoExcluir),o(4),l("imagem",i.imagemSelecionada)("aberto",i.modalAberto))},dependencies:[q,z,j,$],styles:[".item-detalhe-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item-detalhe-container[_ngcontent-%COMP%]{width:100%;max-width:900px;margin:0 auto}.detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{height:220px;object-fit:cover;width:100%}.raridade[_ngcontent-%COMP%]{font-weight:700;padding:2px 8px;border-radius:6px}.raridade.comum[_ngcontent-%COMP%]{color:#ccc}.raridade.incomum[_ngcontent-%COMP%]{color:#00bcd4}.raridade.raro[_ngcontent-%COMP%]{color:#673ab7}.raridade.lendario[_ngcontent-%COMP%]{color:gold}.descricao-text[_ngcontent-%COMP%]{white-space:pre-line;color:#ddd;font-size:.95rem;background:#2a2a2a;border-radius:6px;padding:8px 10px;line-height:1.4;margin-top:8px}.fab-stack[_ngcontent-%COMP%]{position:fixed;bottom:70px;right:20px;display:flex;flex-direction:column;gap:15px;z-index:1000}.fab[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;font-size:1.6rem;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 14px #0006;transition:transform .2s ease}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.08)}.fab-primary[_ngcontent-%COMP%]{background:#0d6efd;color:#fff}.fab-primary[_ngcontent-%COMP%]:hover{background:#0b5ed7}.fab-warning[_ngcontent-%COMP%]{background:#ffc107;color:#000}.fab-warning[_ngcontent-%COMP%]:hover{background:#e0a800}.fab-danger[_ngcontent-%COMP%]{background:#ff4d6d;color:#fff}.fab-danger[_ngcontent-%COMP%]:hover{background:#e63e5b}@media (min-width: 992px){.item-detalhe-container[_ngcontent-%COMP%]{padding:0 2rem}.detalhe-card[_ngcontent-%COMP%]{border-radius:16px}.fab-stack[_ngcontent-%COMP%]{right:calc(50% - 430px)}}.fallback-icone[_ngcontent-%COMP%]{font-size:3rem}.ingredientes-wrapper[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:8px;margin-top:15px}.ingredientes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:10px}.ingrediente-card[_ngcontent-%COMP%]{background:#212529;border:1px solid #333;border-radius:8px;padding:8px 12px;display:flex;align-items:center;justify-content:space-between}.ingrediente-card[_ngcontent-%COMP%]   .nome[_ngcontent-%COMP%]{color:#f8f9fa;font-size:.9rem;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ingrediente-card[_ngcontent-%COMP%]   .qtd[_ngcontent-%COMP%]{font-weight:700;color:#0dcaf0;font-size:.85rem}.thumb-mini[_ngcontent-%COMP%]{width:28px;height:28px;object-fit:cover;border-radius:6px;border:1px solid #555}.producao-card[_ngcontent-%COMP%]{background:#1e1e1e;border:1px solid #333;border-radius:10px;padding:12px;margin-top:10px}.producao-card[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{font-weight:600;color:#0dcaf0;margin-bottom:4px;font-size:.9rem}.producao-card[_ngcontent-%COMP%]   .quantidade[_ngcontent-%COMP%]{font-weight:700;color:#28a745;font-size:1rem}.link-hover[_ngcontent-%COMP%]{cursor:pointer;color:#0dcaf0;transition:color .2s ease}.link-hover[_ngcontent-%COMP%]:hover{color:#17a2b8;text-decoration:underline}"]})};export{L as ItemCatalogo};
