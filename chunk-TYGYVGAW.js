import{a as f}from"./chunk-FJZA3HMC.js";import"./chunk-W7DVKRY2.js";import"./chunk-HS244SCX.js";import{Ga as l,Ha as i,Ia as n,Ib as M,Ja as v,Jb as O,Mb as P,Na as C,Oa as y,Ta as p,Tb as w,Vb as F,a as D,b as E,d as _,fb as a,gb as u,ha as I,hb as s,ia as r,ib as J,ma as h,qa as S,ua as g}from"./chunk-ILJPX4RU.js";function z(o,t){o&1&&(i(0,"div",5),v(1,"div",6),i(2,"p",7),a(3,"Carregando personagem..."),n()())}function T(o,t){if(o&1&&(C(0),v(1,"img",18),y()),o&2){let e=p(2);r(),l("src",e.jogador.imagem,I)}}function j(o,t){if(o&1&&(i(0,"div",19),a(1),i(2,"span"),a(3),n(),i(4,"b"),a(5),n(),i(6,"small"),a(7),n()()),o&2){let e=t.$implicit;r(),s(" ",e.icon," "),r(2),u(e.label),r(2),u(e.value),r(2),s("(",e.mod>=0?"+"+e.mod:e.mod,")")}}function q(o,t){if(o&1&&(i(0,"p",25),a(1),n()),o&2){let e=p(3);r(),u(e.jogador.descricao)}}function A(o,t){o&1&&(i(0,"h6",26),a(1,"\u2694\uFE0F Ataques"),n())}function R(o,t){if(o&1&&(i(0,"p",27),a(1),n()),o&2){let e=p(3);r(),u(e.jogador.ataques)}}function N(o,t){if(o&1&&(i(0,"div",20)(1,"h6",21),a(2,"\u{1F4DD} Descri\xE7\xE3o"),n(),g(3,q,2,1,"p",22)(4,A,2,0,"h6",23)(5,R,2,1,"p",24),n()),o&2){let e=p(2);r(3),l("ngIf",e.jogador.descricao),r(),l("ngIf",e.jogador.ataques),r(),l("ngIf",e.jogador.ataques)}}function k(o,t){if(o&1&&(i(0,"div",8),g(1,T,2,1,"ng-container",9),i(2,"div",10)(3,"h4",11),a(4),n(),i(5,"p",12),a(6),n(),i(7,"ul",13)(8,"li"),a(9,"\u2B50 "),i(10,"span"),a(11,"XP:"),n(),a(12),n(),i(13,"li"),a(14,"\u2764\uFE0F "),i(15,"span"),a(16,"Vida:"),n(),a(17),n(),i(18,"li"),a(19,"\u{1F6E1}\uFE0F "),i(20,"span"),a(21,"Armadura:"),n(),a(22),n(),i(23,"li"),a(24,"\u{1F494} "),i(25,"span"),a(26,"Dano tomado:"),n(),a(27),n(),i(28,"li"),a(29,"\u2728 "),i(30,"span"),a(31,"Fator de cura:"),n(),a(32),n(),i(33,"li"),a(34,"\u{1F6B6}\u200D\u2642\uFE0F "),i(35,"span"),a(36,"Deslocamento:"),n(),a(37),n()(),i(38,"h6",14),a(39,"\u{1F4CA} Atributos"),n(),i(40,"div",15),g(41,j,8,4,"div",16),n(),g(42,N,6,3,"div",17),n()()),o&2){let e=p();r(),l("ngIf",e.jogador.imagem),r(3),J(" ",e.jogador.email?"\u{1F9D9}":"\u{1F479}"," ",e.jogador.personagem," "),r(2),s(" \u2696\uFE0F ",e.jogador.alinhamento||"Sem alinhamento"," "),r(6),s(" ",e.jogador.xp),r(5),s(" ",e.jogador.pontos_de_vida),r(5),s(" ",e.jogador.classe_de_armadura),r(5),s(" ",e.jogador.dano_tomado),r(5),s(" ",e.jogador.fator_cura),r(5),s(" ",e.jogador.deslocamento),r(4),l("ngForOf",e.atributos),r(),l("ngIf",!e.jogador.email)}}function U(o,t){o&1&&(i(0,"div",28),a(1," Nenhum personagem encontrado. "),n())}var B=class o{constructor(t,e){this.route=t;this.router=e}jogador=null;atributos=[];loading=!0;ngOnInit(){return _(this,null,function*(){let t=this.route.snapshot.paramMap.get("id");if(!t){this.router.navigate(["/batalha"]);return}try{let d=(yield f.getLocalJogadores()).find(m=>String(m.id)===String(t))||null;if(d)this.setJogador(d),f.syncJogadores().then(m=>_(this,null,function*(){if(m){let c=(yield f.getLocalJogadores()).find(x=>String(x.id)===String(t));c&&this.setJogador(c)}}));else{let m=yield f.forceFetchJogador();m&&String(m.id)===String(t)&&this.setJogador(m)}}catch(e){console.error("[JogadorDetalhesBatalha] Erro:",e)}finally{this.loading=!1}})}setJogador(t){let e=t.pontos_de_vida&&t.pontos_de_vida>0?t.pontos_de_vida:t.energia+t.constituicao,d=Math.floor(t.energia/3),m=e+t.classe_de_armadura,b=Math.floor(t.destreza/3);this.jogador=E(D({},t),{pontos_de_vida:e,fator_cura:d,vida_total:m,deslocamento:b});let c=x=>Math.floor((x-10)/2);this.atributos=[{label:"For\xE7a",value:t.forca,mod:c(t.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:t.destreza,mod:c(t.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:t.constituicao,mod:c(t.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:t.inteligencia,mod:c(t.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:t.sabedoria,mod:c(t.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:t.carisma,mod:c(t.carisma),icon:"\u{1F60E}"},{label:"Energia",value:t.energia,mod:c(t.energia),icon:"\u26A1"}]}editarJogador(){if(this.jogador){if(!this.jogador.email){this.router.navigate(["/cadastro-npc",this.jogador.id],{queryParams:{returnUrl:this.router.url}});return}this.router.navigate(["/cadastro-jogador",this.jogador.id],{queryParams:{returnUrl:this.router.url}})}}static \u0275fac=function(e){return new(e||o)(h(w),h(F))};static \u0275cmp=S({type:o,selectors:[["app-jogador-detalhes-batalha"]],decls:5,vars:3,consts:[[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","pb-5"],["class","text-center py-5",4,"ngIf"],["class","card detalhe-card shadow-lg border-0",4,"ngIf"],["class","alert alert-warning mt-4",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"card","detalhe-card","shadow-lg","border-0"],[4,"ngIf"],[1,"card-body","pb-5"],[1,"fw-bold","mb-1","text-light"],[1,"text-secondary","mb-3"],[1,"info-list","mb-3"],[1,"fw-bold","mt-3","text-light"],[1,"atributos-grid","compact","mb-3"],["class","atributo-item",4,"ngFor","ngForOf"],["class","mt-3",4,"ngIf"],["alt","Imagem do personagem",1,"card-img-top","detalhe-img",3,"src"],[1,"atributo-item"],[1,"mt-3"],[1,"fw-bold","text-light"],["class","descricao-text",4,"ngIf"],["class","fw-bold text-light mt-3",4,"ngIf"],["class","ataques-text",4,"ngIf"],[1,"descricao-text"],[1,"fw-bold","text-light","mt-3"],[1,"ataques-text"],[1,"alert","alert-warning","mt-4"]],template:function(e,d){e&1&&(i(0,"div",0)(1,"div",1),g(2,z,4,0,"div",2)(3,k,43,12,"div",3)(4,U,2,0,"div",4),n()()),e&2&&(r(2),l("ngIf",d.loading),r(),l("ngIf",!d.loading&&d.jogador),r(),l("ngIf",!d.loading&&!d.jogador))},dependencies:[P,M,O],styles:[".detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{max-height:220px;object-fit:cover}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:.95rem}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:#f1f1f1}.info-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px 12px;font-size:.9rem;color:#f1f1f1}.atributo-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;white-space:nowrap;font-size:.9rem;background:#2a2a2a;border-radius:6px;padding:4px 8px}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#ccc;margin-right:2px}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#aaa;margin-left:2px}.descricao-text[_ngcontent-%COMP%]{color:#ddd;font-size:.95rem}.ataques-text[_ngcontent-%COMP%]{color:#f8d775;font-size:.9rem}"]})};export{B as JogadorDetalhesBatalha};
