import{a as f}from"./chunk-N245TVBG.js";import"./chunk-VZT3XYFG.js";import{Ia as l,Ja as i,Ka as n,La as v,Lb as J,Mb as P,Nb as w,Pa as S,Qa as y,Qb as F,Va as p,Xb as B,Zb as z,a as D,b as C,d as _,hb as a,ib as u,ja as E,jb as d,ka as r,kb as M,oa as h,sa as I,sb as O,wa as g}from"./chunk-Y44Y2XZC.js";var q=o=>({"text-danger fw-bold":o});function T(o,e){o&1&&(i(0,"div",5),v(1,"div",6),i(2,"p",7),a(3,"Carregando personagem..."),n()())}function A(o,e){if(o&1&&(S(0),v(1,"img",19),y()),o&2){let t=p(2);r(),l("src",t.jogador.imagem,E)}}function R(o,e){if(o&1&&(i(0,"div",20),a(1),i(2,"span"),a(3),n(),i(4,"b"),a(5),n(),i(6,"small",21),a(7),n()()),o&2){let t=e.$implicit;r(),d(" ",t.icon," "),r(2),u(t.label),r(2),u(t.value),r(2),d("(",t.mod>=0?"+"+t.mod:t.mod,")")}}function N(o,e){if(o&1&&(i(0,"p",27),a(1),n()),o&2){let t=p(3);r(),u(t.jogador.descricao)}}function k(o,e){o&1&&(i(0,"h6",28),a(1,"\u2694\uFE0F Ataques"),n())}function U(o,e){if(o&1&&(i(0,"p",29),a(1),n()),o&2){let t=p(3);r(),u(t.jogador.ataques)}}function L(o,e){if(o&1&&(i(0,"div",22)(1,"h6",23),a(2,"\u{1F4DD} Descri\xE7\xE3o"),n(),g(3,N,2,1,"p",24)(4,k,2,0,"h6",25)(5,U,2,1,"p",26),n()),o&2){let t=p(2);r(3),l("ngIf",t.jogador.descricao),r(),l("ngIf",t.jogador.ataques),r(),l("ngIf",t.jogador.ataques)}}function V(o,e){if(o&1&&(i(0,"div",8),g(1,A,2,1,"ng-container",9),i(2,"div",10)(3,"h4",11),a(4),n(),i(5,"p",12),a(6),n(),i(7,"ul",13)(8,"li"),a(9,"\u2B50 "),i(10,"span"),a(11,"XP:"),n(),a(12),n(),i(13,"li"),a(14," \u2764\uFE0F "),i(15,"span"),a(16,"Vida:"),n(),i(17,"span",14),a(18),n(),a(19),n(),i(20,"li"),a(21,"\u{1F6E1}\uFE0F "),i(22,"span"),a(23,"Armadura:"),n(),a(24),n(),i(25,"li"),a(26,"\u{1F494} "),i(27,"span"),a(28,"Dano tomado:"),n(),a(29),n(),i(30,"li"),a(31,"\u2728 "),i(32,"span"),a(33,"Fator de cura:"),n(),a(34),n(),i(35,"li"),a(36,"\u{1F6B6}\u200D\u2642\uFE0F "),i(37,"span"),a(38,"Deslocamento:"),n(),a(39),n()(),i(40,"h6",15),a(41,"\u{1F4CA} Atributos"),n(),i(42,"div",16),g(43,R,8,4,"div",17),n(),g(44,L,6,3,"div",18),n()()),o&2){let t=p();r(),l("ngIf",t.jogador.imagem),r(3),M(" ",t.jogador.email?"\u{1F9D9}":"\u{1F479}"," ",t.jogador.personagem," "),r(2),d(" \u2696\uFE0F ",t.jogador.alinhamento||"Sem alinhamento"," "),r(6),d(" ",t.jogador.xp),r(5),l("ngClass",O(14,q,t.jogador.vida_atual<=0)),r(),d(" ",t.jogador.vida_atual," "),r(),d(" / ",t.jogador.pontos_de_vida," "),r(5),d(" ",t.jogador.classe_de_armadura),r(5),d(" ",t.jogador.dano_tomado),r(5),d(" ",t.jogador.fator_cura),r(5),d(" ",t.jogador.deslocamento),r(4),l("ngForOf",t.atributos),r(),l("ngIf",!t.jogador.email)}}function X(o,e){o&1&&(i(0,"div",30),a(1," Nenhum personagem encontrado. "),n())}var j=class o{constructor(e,t){this.route=e;this.router=t}jogador=null;atributos=[];loading=!0;ngOnInit(){return _(this,null,function*(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.router.navigate(["/batalha"]);return}try{let c=(yield f.getLocalJogadores()).find(m=>String(m.id)===String(e))||null;if(c)this.setJogador(c),f.syncJogadores().then(m=>_(this,null,function*(){if(m){let s=(yield f.getLocalJogadores()).find(x=>String(x.id)===String(e));s&&this.setJogador(s)}}));else{let m=yield f.forceFetchJogador();m&&String(m.id)===String(e)&&this.setJogador(m)}}catch(t){console.error("[JogadorDetalhesBatalha] Erro:",t)}finally{this.loading=!1}})}setJogador(e){let t=e.pontos_de_vida&&e.pontos_de_vida>0?e.pontos_de_vida:e.energia+e.constituicao,c=Math.floor(e.energia/3),m=Math.floor(e.destreza/3),b=e.classe_de_armadura>0?t:t-(e.dano_tomado||0);this.jogador=C(D({},e),{pontos_de_vida:t,vida_atual:b,fator_cura:c,deslocamento:m});let s=x=>Math.floor((x-10)/2);this.atributos=[{label:"For\xE7a",value:e.forca,mod:s(e.forca),icon:"\u{1F4AA}"},{label:"Destreza",value:e.destreza,mod:s(e.destreza),icon:"\u{1F938}\u200D\u2642\uFE0F"},{label:"Constitui\xE7\xE3o",value:e.constituicao,mod:s(e.constituicao),icon:"\u{1FAA8}"},{label:"Intelig\xEAncia",value:e.inteligencia,mod:s(e.inteligencia),icon:"\u{1F9E0}"},{label:"Sabedoria",value:e.sabedoria,mod:s(e.sabedoria),icon:"\u{1F4D6}"},{label:"Carisma",value:e.carisma,mod:s(e.carisma),icon:"\u{1F60E}"},{label:"Energia",value:e.energia,mod:s(e.energia),icon:"\u26A1"}]}editarJogador(){if(this.jogador){if(!this.jogador.email){this.router.navigate(["/cadastro-npc",this.jogador.id],{queryParams:{returnUrl:this.router.url}});return}this.router.navigate(["/cadastro-jogador",this.jogador.id],{queryParams:{returnUrl:this.router.url}})}}static \u0275fac=function(t){return new(t||o)(h(B),h(z))};static \u0275cmp=I({type:o,selectors:[["app-jogador-detalhes-batalha"]],decls:5,vars:3,consts:[[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"flex-grow-1","pb-5"],["class","text-center py-5",4,"ngIf"],["class","card detalhe-card shadow-lg border-0",4,"ngIf"],["class","alert alert-warning mt-4",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],[1,"card","detalhe-card","shadow-lg","border-0"],[4,"ngIf"],[1,"card-body","pb-5"],[1,"fw-bold","mb-1","text-light"],[1,"text-secondary","mb-3"],[1,"info-list","mb-3"],[3,"ngClass"],[1,"fw-bold","mt-3","text-light"],[1,"atributos-grid","compact","mb-3"],["class","atributo-item",4,"ngFor","ngForOf"],["class","mt-3",4,"ngIf"],["alt","Imagem do personagem",1,"card-img-top","detalhe-img",3,"src"],[1,"atributo-item"],[1,"text-light"],[1,"mt-3"],[1,"fw-bold","text-light"],["class","descricao-text",4,"ngIf"],["class","fw-bold text-light mt-3",4,"ngIf"],["class","ataques-text",4,"ngIf"],[1,"descricao-text"],[1,"fw-bold","text-light","mt-3"],[1,"ataques-text"],[1,"alert","alert-warning","mt-4"]],template:function(t,c){t&1&&(i(0,"div",0)(1,"div",1),g(2,T,4,0,"div",2)(3,V,45,16,"div",3)(4,X,2,0,"div",4),n()()),t&2&&(r(2),l("ngIf",c.loading),r(),l("ngIf",!c.loading&&c.jogador),r(),l("ngIf",!c.loading&&!c.jogador))},dependencies:[F,J,P,w],styles:[".detalhe-card[_ngcontent-%COMP%]{background:#1e1e1e;border-radius:12px;overflow:hidden}.detalhe-img[_ngcontent-%COMP%]{max-height:220px;object-fit:cover}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:.95rem}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:#f1f1f1}.info-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#f8f9fa}.atributos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px 12px;font-size:.9rem;color:#f1f1f1}.atributo-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;white-space:nowrap;font-size:.9rem;background:#2a2a2a;border-radius:6px;padding:4px 8px}.atributo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#ccc;margin-right:2px}.atributo-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#fff}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#aaa;margin-left:2px}.descricao-text[_ngcontent-%COMP%]{color:#ddd;font-size:.95rem}.ataques-text[_ngcontent-%COMP%]{color:#f8d775;font-size:.9rem}.atributo-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#f8f9fa!important}.descricao-text[_ngcontent-%COMP%], .ataques-text[_ngcontent-%COMP%]{white-space:pre-line;color:#ddd;font-size:.95rem;background:#2a2a2a;border-radius:6px;padding:8px 10px;line-height:1.4}.ataques-text[_ngcontent-%COMP%]{color:#f8d775}"]})};export{j as JogadorDetalhesBatalha};
