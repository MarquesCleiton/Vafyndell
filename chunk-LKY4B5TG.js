import{a as g}from"./chunk-FJZA3HMC.js";import{b as $,e as R,h as L,q as A}from"./chunk-6EPUS52O.js";import"./chunk-W7DVKRY2.js";import"./chunk-HS244SCX.js";import{Ga as d,Ha as o,Ia as n,Ib as k,Ja as v,Jb as P,Mb as N,Na as F,Oa as B,Pa as b,Ra as u,S as x,T as h,Ta as s,Vb as V,a as C,b as I,bb as y,d as f,fb as l,gb as S,ha as D,hb as p,ia as r,kb as M,lb as T,ma as w,mb as J,nb as O,qa as j,sb as E,ua as c}from"./chunk-ILJPX4RU.js";function W(e,i){e&1&&(o(0,"div",10),v(1,"div",11),o(2,"p",12),l(3,"Carregando jogadores..."),n()())}function q(e,i){if(e&1&&v(0,"img",27),e&2){let t=s().$implicit;d("alt",O(t.personagem))("src",t.imagem,D)}}function U(e,i){e&1&&(o(0,"span",23),l(1,"\u{1F464}"),n())}function Y(e,i){if(e&1&&(o(0,"span",30),l(1),n()),e&2){let t=s(2).$implicit;r(),p(" \u{1F6E1}\uFE0F ",t.classe_de_armadura," ")}}function G(e,i){e&1&&(o(0,"span",28),l(1,"\u{1F6E1}\uFE0F\u274C"),n())}function H(e,i){if(e&1&&(F(0),o(1,"span",28),l(2),n(),c(3,Y,2,1,"span",29)(4,G,2,0,"ng-template",null,1,E),B()),e&2){let t=y(5),a=s().$implicit;r(2),p("\u2764\uFE0F ",a.pontos_de_vida),r(),d("ngIf",a.classe_de_armadura>0)("ngIfElse",t)}}function K(e,i){e&1&&(o(0,"span",31),l(1,"\u{1F480} \u26B0\uFE0F"),n())}function Q(e,i){if(e&1&&(o(0,"span"),l(1),n()),e&2){let t=s().$implicit;r(),p("| ",t.tipo)}}function X(e,i){if(e&1&&(o(0,"span"),l(1),n()),e&2){let t=s().$implicit;r(),p("| ",t.tipo)}}function Z(e,i){if(e&1){let t=b();o(0,"button",32),u("click",function(){x(t);let _=s().$implicit,m=s(2);return h(m.excluirNpcDaBatalha(_))}),l(1," \u{1F5D1}\uFE0F "),n()}}function tt(e,i){if(e&1){let t=b();o(0,"div",14)(1,"div",15)(2,"div",16),c(3,q,1,3,"img",17)(4,U,2,0,"span",18),n(),o(5,"div",19)(6,"h6",20)(7,"span",21),l(8),n(),c(9,H,6,3,"ng-container",22)(10,K,2,0,"ng-template",null,0,E),n(),o(12,"small",23),l(13),c(14,Q,2,1,"span",8),n(),o(15,"small",23),l(16),c(17,X,2,1,"span",8),n()(),o(18,"div",24)(19,"button",25),u("click",function(){let _=x(t).$implicit,m=s(2);return h(m.abrirJogador(_))}),l(20," \u2694\uFE0F "),n(),c(21,Z,2,0,"button",26),n()()()}if(e&2){let t=i.$implicit,a=y(11);r(3),d("ngIf",t.imagem),r(),d("ngIf",!t.imagem),r(4),S(t.personagem),r(),d("ngIf",t.pontos_de_vida>0)("ngIfElse",a),r(4),p(" ",t.classificacao||"Jogador"," "),r(),d("ngIf",t.tipo),r(2),p(" ",t.classificacao||"Jogador"," "),r(),d("ngIf",t.tipo),r(4),d("ngIf",!t.email)}}function et(e,i){if(e&1&&(o(0,"div"),c(1,tt,22,10,"div",13),n()),e&2){let t=s();r(),d("ngForOf",t.jogadoresFiltrados)}}function it(e,i){e&1&&(o(0,"div",33),l(1," Nenhum jogador encontrado. "),n())}var z=class e{constructor(i){this.router=i}jogadores=[];jogadoresFiltrados=[];carregando=!0;filtro="";ngOnInit(){return f(this,null,function*(){try{let i=yield g.getAllJogadores();i.length>0&&(this.jogadores=i,this.aplicarFiltro()),g.syncJogadores().then(t=>f(this,null,function*(){if(t){let a=yield g.getAllJogadores();this.jogadores=a,this.aplicarFiltro()}}))}catch(i){console.error("[Batalha] Erro ao carregar jogadores:",i)}finally{this.carregando=!1}})}aplicarFiltro(){let i=this.filtro.toLowerCase().trim();if(!i){this.jogadoresFiltrados=[...this.jogadores];return}this.jogadoresFiltrados=this.jogadores.filter(t=>String(t.personagem||"").toLowerCase().includes(i)||String(t.nome_do_jogador||"").toLowerCase().includes(i)||String(t.classificacao||"").toLowerCase().includes(i)||String(t.tipo||"").toLowerCase().includes(i))}abrirJogador(i){this.router.navigate(["/jogador",i.id])}excluirNpcDaBatalha(i){return f(this,null,function*(){if(confirm(`\u{1F5D1}\uFE0F Deseja remover "${i.personagem}" do campo de batalha?`))try{yield g.updateJogador(I(C({},i),{personagem:`[REMOVIDO] ${i.personagem}`})),yield g.deleteJogador(i.id),this.jogadores=this.jogadores.filter(a=>a.id!==i.id),this.aplicarFiltro(),alert("\u2705 NPC removido da batalha!")}catch(a){console.error("[Batalha] Erro ao excluir NPC:",a),alert("\u274C Erro ao excluir NPC da batalha.")}})}static \u0275fac=function(t){return new(t||e)(w(V))};static \u0275cmp=j({type:e,selectors:[["app-batalha"]],decls:9,vars:4,consts:[["morto",""],["semArmadura",""],[1,"d-flex","flex-column","min-vh-100","bg-dark","text-light"],[1,"p-3","bg-black","border-bottom","d-flex","justify-content-between","align-items-center","sticky-top"],[1,"m-0"],["type","text","placeholder","\u{1F50D} Pesquisar...",1,"form-control","bg-dark","text-light","border-light","rounded-pill","ms-3",2,"max-width","250px",3,"ngModelChange","input","ngModel"],[1,"flex-grow-1","p-2","overflow-auto"],["class","text-center py-5",4,"ngIf"],[4,"ngIf"],["class","text-center text-muted py-5",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-light"],[1,"mt-2"],["class","card bg-secondary text-light mb-2 shadow-sm jogador-card",4,"ngFor","ngForOf"],[1,"card","bg-secondary","text-light","mb-2","shadow-sm","jogador-card"],[1,"d-flex","align-items-center","p-2","position-relative"],[1,"rounded","me-3","d-flex","align-items-center","justify-content-center","bg-dark",2,"width","55px","height","55px","overflow","hidden"],["style","width: 100%; height: 100%; object-fit: cover;",3,"src","alt",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"flex-grow-1"],[1,"fw-bold","mb-1","d-flex","align-items-center"],[1,"me-3"],[4,"ngIf","ngIfElse"],[1,"text-muted"],[1,"d-flex","ms-2"],[1,"btn","btn-sm","btn-outline-light","me-1",3,"click"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[2,"width","100%","height","100%","object-fit","cover",3,"src","alt"],[1,"me-2","text-danger"],["class","me-2 text-primary",4,"ngIf","ngIfElse"],[1,"me-2","text-primary"],[1,"me-2"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"text-center","text-muted","py-5"]],template:function(t,a){t&1&&(o(0,"div",2)(1,"div",3)(2,"h5",4),l(3,"\u2694\uFE0F Batalha"),n(),o(4,"input",5),J("ngModelChange",function(m){return T(a.filtro,m)||(a.filtro=m),m}),u("input",function(){return a.aplicarFiltro()}),n()(),o(5,"div",6),c(6,W,4,0,"div",7)(7,et,2,1,"div",8)(8,it,2,0,"div",9),n()()),t&2&&(r(4),M("ngModel",a.filtro),r(2),d("ngIf",a.carregando),r(),d("ngIf",!a.carregando&&a.jogadoresFiltrados.length>0),r(),d("ngIf",!a.carregando&&a.jogadoresFiltrados.length===0))},dependencies:[N,k,P,A,$,R,L],styles:[".jogador-card[_ngcontent-%COMP%]{border-radius:10px;transition:transform .15s ease}.jogador-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.jogador-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .jogador-card[_ngcontent-%COMP%]   .bg-dark[_ngcontent-%COMP%]{width:55px;height:55px;border-radius:6px}button.btn[_ngcontent-%COMP%]{border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;font-size:18px;padding:0}"]})};export{z as Batalha};
